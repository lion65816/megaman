====================================================================================================
ロックマン１　トゲをダメージ化

・ウェブサイト
　　　　　http://borokobo.web.fc2.com/
　　　　　（Neoぼろくず工房）
　　　　　http://www.geocities.jp/borokobo/
　　　　　（Neoぼろくず工房別館）

====================================================================================================
●あいさつ
　本パッチをＤＬしていただき、ありがとうございます。

●免責
　使用は自己責任でお願い致します。

●概要
　即死のトゲをダメージ(デフォルトで4ダメージ)に変更します。

●ダメージ調整方法
　パッチを当てた後のバイナリから、
A5 6A E9 04
　を検索した時、最後のバイトの04がダメージ量です。

●不具合・補足など
・基本的にロクにテストしていないのでバグるかもしれません。
・ノックバック方向は、向いている方向と逆です。
・アイテムはトゲに埋まってしまう一方、ロックマンはトゲに乗る形となっています。
　埋まったアイテムは取れないし、そもそも少々不自然？

●更新履歴
◎Ver.1.00(2016年7月3日)
　初版

●ソース・利用条件など
　ご自由に流用してください。
　以下、アセンブリソースとなっています。
　私にしか通用しないような表現やマクロ等がありますが、
　適時置き換えてお読みください。

	BANKORG_D $0ED7DE ;トゲに横から触れた時
	jmp SpikeDamage_H

	BANKORG_D $0ED81B ;トゲに縦に触れた時
	jmp SpikeDamage_V


	BANKORG_D $0FFF00 ;空き領域を利用
SpikeDamage_H:
	jsr SpikeDamage_Common
	ldy #$01
	jmp $D7D9

SpikeDamage_V:
	jsr SpikeDamage_Common
	lda #$00
	jmp $D7FF

SpikeDamage_Common:
	lda <$55 ;無敵時間
	bne .NotDamage
	sec
	lda <$6A ;HP
	sbc #(4) ;ダメージ量
	bpl .NotFixHP
	lda #$00
.NotFixHP
	sta <$6A ;HP
	beq .Dead
	lda $0420+0
	ora #$03
	sta $0420+0 ;ノックバック状態に移行する
	lda #$6F
	sta <$55 ;無敵時間
.NotDamage
	rts
.Dead
	pla
	pla
	jmp $C219 ;死亡時の処理


/*!
 * Advertisement Library
 * Version     2.32.8.fa0ef225945dc3391d0cfec4c6bd567d17ef12b1
 * Build Date  20220621
 * 
 * 
 * This library uses a part of prototype.js.
 * - Prototype is freely distributable under the terms of an MIT-style license.
 *   For details, see the Prototype web site: http://www.prototypejs.org/
 * 
 * This library uses `Ads` namespace.
 * This library has no Object.prototype pollution.
 */!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMetaTagContent=t.observationLazyLoad=t.updateElement=t.canPlayMp4=t.cumulativeOffset=t.toArray=t.getPageUrl=t.hasIntersection=t.count=t.indexOf=t.map=t.deleteEmptyFromArray=t.toQueryString=t.isBackCompat=t.addEvent=t.replaceTimestampToRandomString=void 0;var i=n(4);function r(e){if(!e)return[];for(var t=e.length||0,n=new Array(t);t--;)n[t]=e[t];return n}t.replaceTimestampToRandomString=function(e){return e.replace(/\[timestamp]/g,function(e){for(var t="abcdefghijklmnopqrstuvwxyz0123456789",n="",i=0;i<e;i++)n+=t[Math.floor(Math.random()*t.length)];return n}(32))},t.addEvent=function(e,t,n,i){void 0===i&&(i=!1),e.addEventListener?e.addEventListener(t,n,i):e.attachEvent?e.attachEvent("on"+t,n):e[t]=function(){e["on"+t](),n()}},t.isBackCompat=!document.compatMode||!!document.compatMode.match(/.*BackCompat.*/i),t.toQueryString=function(e){var t="";for(var n in e)null!==e[n]&&void 0!==e[n]&&(t+=n+"="+encodeURIComponent(e[n])+"&");return t.slice(0,t.length-1)},t.deleteEmptyFromArray=function(e){return e.filter(function(e){return e&&""!==e})},t.map=function(e,t){for(var n=[],i=0,r=e;i<r.length;i++){var o=r[i];n.push(t(o))}return n},t.indexOf=function(e,t){if("[object Array]"!=Object.prototype.toString.call(e))return-1;for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},t.count=function(e){var t=0;for(var n in e)e.hasOwnProperty(n)&&t++;return t},t.hasIntersection=function(e,t){for(var n=0,i=e;n<i.length;n++)for(var r=i[n],o=0,s=t;o<s.length;o++)if(r===s[o])return!0;return!1},t.getPageUrl=function(e){return e||location.href},t.toArray=r,t.cumulativeOffset=function(e){var t=0,n=0;if(e.parentNode)do{t+=e.offsetTop||0,n+=e.offsetLeft||0,e=e.offsetParent}while(e);return{left:n,top:t}},t.canPlayMp4=function(){var e=document.createElement("video");return void 0!==e.canPlayType&&!!e.canPlayType('video/mp4; codecs="avc1.4D401E, mp4a.40.2"')};var o=function(){try{var e=document.createElement("table");if(e&&e.tBodies){e.innerHTML="<tbody><tr><td>test</td></tr></tbody>";var t=void 0===e.tBodies[0];return e=null,t}}catch(e){return!0}}();var s={before:function(e,t){e.parentNode.insertBefore(t,e)},top:function(e,t){e.insertBefore(t,e.firstChild)},bottom:function(e,t){e.appendChild(t)},after:function(e,t){e.parentNode.insertBefore(t,e.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}};t.updateElement=function(e,t){if(null==e.tagName)return!1;var n=e.tagName.toUpperCase();if(o)if(n in s.tags)for(var i=0,a=function(e,t,n){void 0===n&&(n=!1);var i=s.tags[e],o=document.createElement("div"),a=!!i;if(!a&&n&&(a=!0,i=["","",0]),a){o.innerHTML="&#160;"+i[0]+t+i[1],o.removeChild(o.firstChild);for(var l=i[2];l--;)o=o.firstChild}else o.innerHTML=t;return r(o.childNodes)}(n,t);i<a.length;i++){var l=a[i];e.appendChild(l)}else e.innerHTML+=t;else e.innerHTML+=t;return!0},t.observationLazyLoad=function(e,t,n){if(0!==e.length&&"src"!==n){var r={rootMargin:t},o=new i.IntersectionObserver(function(e,t){return e.forEach(function(e){if(e.isIntersecting){var i=e.target;(i instanceof HTMLIFrameElement||i instanceof HTMLImageElement||i instanceof HTMLVideoElement)&&(i.src=i.getAttribute(n),i.removeAttribute(n),t.unobserve(i))}})},r);Array.prototype.forEach.call(e,function(e){return o.observe(e)})}},t.getMetaTagContent=function(e){var t=document.querySelector('meta[name="'+e+'"]');return null==t?void 0:t.content}},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.Api=void 0;var r=n(17),o=n(0),s=n(2),a=function(){function e(){}return e.getAdvertisements=function(t,n){var r=o.getPageUrl(window.Ads.pageUrl),a=s.Utility.getPageVariant(),l=i(i({},n),{zone:t.join(","),pageurl:r,pagevariant:a});return e.callJsonpApi(window.Ads.pathBase+e.url.OxBannerService.getAdvertisements,l)},e.getAllAdvertisements=function(t,n){var r=o.getPageUrl(window.Ads.pageUrl),a=s.Utility.getPageVariant(),l=i(i({},n),{zone:t.join(","),pageurl:r,pagevariant:a});return e.callJsonpApi(window.Ads.pathBase+e.url.OxBannerService.getAllAdvertisements,l)},e.getAdvertisementsAndLogImpression=function(t,n){var r=o.getPageUrl(window.Ads.pageUrl),a=s.Utility.getPageVariant(),l=i(i({},n),{zone:t.join(","),pageurl:r,pagevariant:a}),d=window.Ads.pathBase+e.url.OxBannerService.getAdvertisementsAndLogImpression;return e.callJsonpApi(d,l).then(function(t){for(var n=0,i=t;n<i.length;n++){var r=i[n];e.callThirdPartyTracking(r)}return t})},e.logImpression=function(t,n,i){var r=window.Ads.pathBase+e.url.OxBannerService.logImpression,o={campaignid:t,bannerid:n,zoneid:i};return e.callJsonpApi(r,o).then()},e.logViewableImpression=function(t,n,i){var r=window.Ads.pathBase+e.url.OxBannerService.logViewableImpression,o={campaignid:t,bannerid:n,zoneid:i};return e.callJsonApi(r,o).then()},e.logEvent=function(t,n,i){return e.callJsonpApi(window.Ads.pathBase+e.url.OxBannerService.logEvent,{bannerid:t,zoneid:n,eventid:i}).then()},e.callThirdPartyTracking=function(e){if(Array.isArray(e.imp_track_urls))for(var t=0,n=e.imp_track_urls;t<n.length;t++){var i=n[t];(new Image).src=o.replaceTimestampToRandomString(i)}},e.callJsonpApi=function(e,t){var n=this;return new r.Promise(function(r,s){var a=document.createElement("script"),l=i(i({},t),{callback:n.setCallback(function(e){!1===e.success?s(e.message):r(e.data)}),_:(new Date).getTime()});window.Ads.removeLoadedSctipt&&(a.onload=function(){var e,t;null===(t=null===(e=a.parentNode)||void 0===e?void 0:e.removeChild)||void 0===t||t.call(e,a),a=null}),a.src=e+o.toQueryString(l),a.type="text/javascript",a.onerror=a.onabort=function(e){s("JSONP API から返却されたスクリプトの実行に失敗しました")},document.getElementsByTagName("head")[0].appendChild(a)})},e.setCallback=function(t){var n=e.prefix+"_"+e.count++;return window[n]=function(e){t(e),window[n]=void 0},n},e.callJsonApi=function(e,t){return new r.Promise(function(n,i){var r=new XMLHttpRequest,s=e+o.toQueryString(t)+"&_="+(new Date).getTime();r.open("GET",s,!0),r.withCredentials=!0,r.onload=function(e){var t=r.responseText;n(JSON.parse(t))},r.onerror=function(e){i("XMLHttpRequestを使ったアクセスに失敗しました")},r.ontimeout=function(e){i("タイムアウトが発生しました")},r.send()})},e.count=0,e.prefix="ads_callback",e.url={OxBannerService:{getAdvertisements:"/api/OxBannerService/getAdvertisements.jsonp?",getAllAdvertisements:"/api/OxBannerService/getAllAdvertisements.jsonp?",getAdvertisementsAndLogImpression:"/api/OxBannerService/getAdvertisementsAndLogImpression.jsonp?",logImpression:"/api/OxBannerService/logImpression.jsonp?",logViewableImpression:"/api/OxBannerService/logViewableImpression.json?",logEvent:"/api/OxBannerService/logEvent.jsonp?"}},e}();t.Api=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Utility=void 0;var i=n(4),r=n(1),o=n(7),s=function(){function e(){}return e.setup=function(){window.addEventListener("message",e.listenResponseMessage,!1)},e.getScroll=function(){return{left:pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,top:pageYOffset||document.documentElement.scrollTop||document.body.scrollTop}},e.getPageVariant=function(){var e=window.Ads.pageVariant;return!e.match(/\W/)&&e.length<=64?e:""},e.listenResponseMessage=function(e){if(e.origin===window.Ads.pathBase){var t;try{t=JSON.parse(e.data)}catch(e){return}o.Message.resolveMessage(e.source,t)}},e.observationViewableImpression=function(e,t,n,o){if(-1!==[1,2,3].indexOf(e.impression)){var s=e.getElement().querySelectorAll("img, iframe");if(0!==s.length){var a,l=e.viewImpThreshold||.5,d=e.viewImpDelay||1e3,h={threshold:l},u=new i.IntersectionObserver(function(e,i){e.forEach(function(e){e.intersectionRatio>=l?null==a&&(a=window.setTimeout(function(){r.Api.logViewableImpression(t,n,o).catch(function(){}),i.unobserve(e.target)},d)):null!=a&&(clearTimeout(a),a=void 0)})},h);Array.prototype.forEach.call(s,function(e){return u.observe(e)})}}},e}();t.Utility=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Template=void 0;var i=n(0),r=n(1),o=function(){function e(e,t){this.videoTagId=null,this.lazyLoadUrlName=null,this.ICON_SPEAKER_ON="data:image/svg+xml;charset=utf8,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M7.342%207.32l3.799-4.095a.663.663%200%2001.781-.16c.266.126.438.418.438.742v16.386c0%20.324-.172.616-.438.743a.663.663%200%2001-.781-.161L7.342%2016.68H4.44A1.44%201.44%200%20013%2015.24V8.76a1.44%201.44%200%20011.44-1.44h2.902zm9.245-1.679a.718.718%200%2001.099-.122c.084-.089.172-.177.256-.261a.72.72%200%2001.98-.037A8.99%208.99%200%200121%2012a8.98%208.98%200%2001-3.08%206.777.718.718%200%2001-.976-.036%2013.513%2013.513%200%2001-.26-.258.72.72%200%2001.039-1.054%207.214%207.214%200%20001.605-1.994l.01-.02.02-.038a7.08%207.08%200%2000.498-1.174%206.993%206.993%200%2000.294-1.352l.006-.05a7.175%207.175%200%2000-1.901-5.721l-.02-.022-.012-.012a7.913%207.913%200%2000-.159-.162l-.028-.028-.021-.02a6.29%206.29%200%2000-.29-.267.722.722%200%2001-.164-.204l-.002-.004-.002-.003-.002-.005v-.001l-.016-.032a.716.716%200%2001.037-.66l.007-.01.004-.009zM14.194%208.01c.065-.068.131-.134.194-.197a.72.72%200%2001.952-.06A5.398%205.398%200%200117.4%2012v.001a5.391%205.391%200%2001-2.09%204.264l-.014.01a.714.714%200%2001-.38.121h-.015a.714.714%200%2001-.51-.21%208.739%208.739%200%2001-.169-.163l-.096-.096a.723.723%200%2001-.118-.155l-.003-.005v-.002a.718.718%200%2001.188-.915A3.585%203.585%200%200015.6%2012c0-1.16-.55-2.194-1.405-2.853a.715.715%200%2001-.066-1.069l.032-.035.033-.034z%22%20fill%3D%22%23FFF%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E",this.ICON_SPEAKER_ON_HOVER="data:image/svg+xml;charset=utf8,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M7.342%207.32l3.799-4.095a.663.663%200%2001.781-.16c.266.126.438.418.438.742v16.386c0%20.324-.172.616-.438.743a.663.663%200%2001-.781-.161L7.342%2016.68H4.44A1.44%201.44%200%20013%2015.24V8.76a1.44%201.44%200%20011.44-1.44h2.902zm9.245-1.679a.718.718%200%2001.099-.122c.084-.089.172-.177.256-.261a.72.72%200%2001.98-.037A8.99%208.99%200%200121%2012a8.98%208.98%200%2001-3.08%206.777.718.718%200%2001-.976-.036%2013.513%2013.513%200%2001-.26-.258.72.72%200%2001.039-1.054%207.214%207.214%200%20001.605-1.994l.01-.02.02-.038a7.08%207.08%200%2000.498-1.174%206.993%206.993%200%2000.294-1.352l.006-.05a7.175%207.175%200%2000-1.901-5.721l-.02-.022-.012-.012a7.913%207.913%200%2000-.159-.162l-.028-.028-.021-.02a6.29%206.29%200%2000-.29-.267.722.722%200%2001-.164-.204l-.002-.004-.002-.003-.002-.005v-.001l-.016-.032a.716.716%200%2001.037-.66l.007-.01.004-.009zM14.194%208.01c.065-.068.131-.134.194-.197a.72.72%200%2001.952-.06A5.398%205.398%200%200117.4%2012v.001a5.391%205.391%200%2001-2.09%204.264l-.014.01a.714.714%200%2001-.38.121h-.015a.714.714%200%2001-.51-.21%208.739%208.739%200%2001-.169-.163l-.096-.096a.723.723%200%2001-.118-.155l-.003-.005v-.002a.718.718%200%2001.188-.915A3.585%203.585%200%200015.6%2012c0-1.16-.55-2.194-1.405-2.853a.715.715%200%2001-.066-1.069l.032-.035.033-.034z%22%20fill%3D%22%230080FF%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E",this.ICON_SPEAKER_OFF="data:image/svg+xml;charset=utf8,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M7.342%207.32l3.799-4.095a.663.663%200%2001.781-.16c.266.126.438.418.438.742v16.386c0%20.324-.172.616-.438.743a.663.663%200%2001-.781-.161L7.342%2016.68H4.44A1.44%201.44%200%20013%2015.24V8.76a1.44%201.44%200%20011.44-1.44h2.902zM17.4%2010.692l2.062-2.062a.785.785%200%20011.11%200l.198.198a.785.785%200%20010%201.11L18.708%2012l2.062%202.062a.785.785%200%20010%201.11l-.198.198a.785.785%200%2001-1.11%200L17.4%2013.308l-2.062%202.062a.785.785%200%2001-1.11%200l-.198-.198a.785.785%200%20010-1.11L16.092%2012%2014.03%209.938a.785.785%200%20010-1.11l.198-.198a.785.785%200%20011.11%200l2.062%202.062z%22%20fill%3D%22%23FFF%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E",this.ICON_SPEAKER_OFF_HOVER="data:image/svg+xml;charset=utf8,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M7.342%207.32l3.799-4.095a.663.663%200%2001.781-.16c.266.126.438.418.438.742v16.386c0%20.324-.172.616-.438.743a.663.663%200%2001-.781-.161L7.342%2016.68H4.44A1.44%201.44%200%20013%2015.24V8.76a1.44%201.44%200%20011.44-1.44h2.902zM17.4%2010.692l2.062-2.062a.785.785%200%20011.11%200l.198.198a.785.785%200%20010%201.11L18.708%2012l2.062%202.062a.785.785%200%20010%201.11l-.198.198a.785.785%200%2001-1.11%200L17.4%2013.308l-2.062%202.062a.785.785%200%2001-1.11%200l-.198-.198a.785.785%200%20010-1.11L16.092%2012%2014.03%209.938a.785.785%200%20010-1.11l.198-.198a.785.785%200%20011.11%200l2.062%202.062z%22%20fill%3D%22%230080FF%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E",this.OPERA_PRE_PROPERTY="-o-",this.MOZILLA_PRE_PROPERTY="-moz-",this.CHROME_PRE_PROPERTY="-webkit-",this.TRANSITION_PROPERTY="transition-property",this.TRANSITION_DURATION="transition-duration",this.TRANSITION_TIMING_FUNCTION="transition-timing-function",this.CLOSEABLE_TRANSITION_PROPERTY="height",this.CLOSEABLE_TRANSITION_DURATION="400ms",this.CLOSEABLE_TRANSITION_TIMING_FUNCTION="ease-in-out",this.advertisement=e,this.response=t,this.advertisement.closeableActionElementId&&(null!==this.advertisement.presetAds?this.setTransitionStyles(!1):this.setTransitionStyles(!0))}return e.prototype.setTransitionStyles=function(e){var t=this,n=this.advertisement.getElement();n.style.width=this.getWidth()+"px",e&&(n.style.height="0px"),n.style.overflow="hidden";var i="";void 0!==n.style[this.OPERA_PRE_PROPERTY+this.TRANSITION_PROPERTY]?i=this.OPERA_PRE_PROPERTY:void 0!==n.style[this.CHROME_PRE_PROPERTY+this.TRANSITION_PROPERTY]?i=this.CHROME_PRE_PROPERTY:void 0!==n.style[this.MOZILLA_PRE_PROPERTY+this.TRANSITION_PROPERTY]&&(i=this.MOZILLA_PRE_PROPERTY),""!==i&&(n.style[i+this.TRANSITION_PROPERTY]=this.CLOSEABLE_TRANSITION_PROPERTY,n.style[i+this.TRANSITION_DURATION]=this.CLOSEABLE_TRANSITION_DURATION,n.style[i+this.TRANSITION_TIMING_FUNCTION]=this.CLOSEABLE_TRANSITION_TIMING_FUNCTION),void 0!==n.style[this.TRANSITION_PROPERTY]&&(n.style[this.TRANSITION_PROPERTY]=this.CLOSEABLE_TRANSITION_PROPERTY,n.style[this.TRANSITION_DURATION]=this.CLOSEABLE_TRANSITION_DURATION,n.style[this.TRANSITION_TIMING_FUNCTION]=this.CLOSEABLE_TRANSITION_TIMING_FUNCTION),window.setTimeout(function(){n.style.height=t.getHeight()+"px"},20)},e.prototype.getTag=function(){var e=null;if(this.isVideo()&&i.canPlayMp4()){if(this.videoTagId="ads_video_id_"+this.getRandomId(),navigator&&navigator.userAgent){var t='<div style="position: relative; width: '+this.getWidth()+"px; height: "+this.getHeight()+'px; background-color: black; padding: 0px;">',n='<img id="img_'+this.videoTagId+'" style="position:absolute; display:block; bottom:8px; left:8px; z-index:10;" src="'+this.ICON_SPEAKER_OFF+'"\n          onclick="(function (self){\n            var el = document.getElementById(\''+this.videoTagId+"');\n            if(el.muted) {\n              el.muted = false;\n              self.src='"+this.ICON_SPEAKER_ON+"';\n            } else {\n              el.muted = true;\n              self.src='"+this.ICON_SPEAKER_OFF+"';\n            }\n          })(this)\"\n\n          onmouseover=\"(function(self){\n            var el = document.getElementById('"+this.videoTagId+"');\n            if(el.muted) {\n              self.src='"+this.ICON_SPEAKER_OFF_HOVER+"';\n            } else {\n              self.src='"+this.ICON_SPEAKER_ON_HOVER+"';\n            }\n          })(this)\"\n\n          onmouseout=\"(function(self){\n            var el = document.getElementById('"+this.videoTagId+"');\n            if(el.muted) {\n              self.src='"+this.ICON_SPEAKER_OFF+"';\n            } else {\n              self.src='"+this.ICON_SPEAKER_ON+"';\n            }\n          })(this)\"\n          />";if(e="<div>",-1!==navigator.userAgent.toLowerCase().indexOf("firefox"))e+=t+n+this.link(this.getVideoMaskTagForFFAndIE9())+this.getTagForVideo()+"</div>";else if(navigator.userAgent.toLowerCase().match("ie 9.0.*trident/5.0")){var r=(this.advertisement.getElement().offsetWidth-this.getWidth())/2+1;e+='<div style="position: relative; text-align: center;">'+n.replace(/display:block/,"display:none").replace(/left:1px/,"left:"+r+"px")+this.link(this.getVideoMaskTagForFFAndIE9())+this.getTagForIE9Video()+"</div>"}else e+=t+n+this.link(this.getTagForVideo())+"</div>";e+="</div>"}}else this.isText()?e=this.link(this.getBannertext()):this.isImage()?e=this.link(this.getTagForImage()):this.isHtml()&&(e=this.getTagForHtml());return e},e.prototype.getCloseableButtonHtml=function(){document.getElementById(this.advertisement.closeableActionElementId).style.width=this.getWidth()+"px";var e=this.advertisement.getElement().id,t="close_"+e+"_"+this.getRandomId();return"<a href='javascript:void(0);' id=\""+t+'" onclick="\n      (function () {\n        var adel = document.getElementById(\''+e+"');\n        var btnel = document.getElementById('"+t+"');\n        if (adel.style.height !== '0px') {\n          btnel.textContent = '"+this.advertisement.closeableButtonText[1]+"';\n          adel.style.height = '0px';\n        } else {\n          btnel.textContent = '"+this.advertisement.closeableButtonText[0]+"';\n          adel.style.height = '"+this.getHeight()+"px'\n        }\n      })();\n    \">"+this.advertisement.closeableButtonText[0]+"</a>"},e.prototype.getTextLinkTag=function(){return this.hasTextLink()?this.link(this.getBannertext()):""},e.prototype.canPlayEventListener=function(){var e=this,t=document.getElementById(this.videoTagId);t.style.display="inline",t.muted=!0;var n=0,i=window.setInterval(function(){var t=document.getElementById(e.videoTagId),o=Math.floor(Math.ceil(t.currentTime/t.duration*100)/25);n<o&&(n=o,r.Api.logEvent(e.response.bannerid,e.response.zoneid,n).catch(function(){}),n>=4&&clearTimeout(i))},200)},e.prototype.logimpressionCallback=function(e){if(!e.success&&e.message)throw new Error(e.message)},e.prototype.getRandomId=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",t="",n=0;n<5;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t+"_"+(new Date).getTime()},e.prototype.getBannertext=function(){return this.response.bannertext||""},e.prototype.getAppend=function(){return this.response.append||""},e.prototype.getTagForImage=function(){var e=this.getLazyLoadUrlName()||"src",t=this.getImagePath().replace(/'/g,"\\x27"),n=this.getBannertext(),i=this.getWidth(),r=this.getHeight(),o="<img "+e+'="'+t+'"\n            alt="'+n+'"\n            width="'+i+'"\n            height="'+r+'"\n            border="0"/>',s="<img "+e+'="'+t+'"\n            onload="this.src=\''+t+"'; this.onload = ''\"\n            alt=\""+n+'"\n            width="'+i+'"\n            height="'+r+'"\n            border="0" />';return"gif"===this.response.contenttype?s:o},e.prototype.getVideoMaskTagForFFAndIE9=function(){return'<img src="data:image/gif;base64,R0lGODlhAQABAJEAAAAAAP///////wAAACH5BAEHAAIALAAAAAABAAEAAAICVAEAOw=="\n                 style="position: absolute; top: 0; left: '+(this.advertisement.getElement().offsetWidth-this.getWidth())/2+"px; width:"+this.getWidth()+"px; height:"+this.getHeight()+'px; z-index: 1; border: none;">'},e.prototype.getTagForVideo=function(){return'<video id="'+this.videoTagId+'" width="'+this.getWidth()+'" height="'+this.getHeight()+'" autoplay muted style="background-color: #000; z-index: 0; display: none;">\n              <source src="'+this.getVideoPath()+'" type="video/mp4">\n            </video>'},e.prototype.getTagForIE9Video=function(){var e=this.videoTagId;return'<video poster="data:image/gif;base64,R0lGODlhAQABAJEAAAAAAP///////wAAACH5BAEHAAIALAAAAAABAAEAAAICVAEAOw==" id="'+e+'" width="'+this.getWidth()+'" height="'+this.getHeight()+'" autoplay style="background-color: #000; z-index: 0; display: none;" oncanplay="(function () { document.getElementById(\''+e+"').style.display = 'block'; document.getElementById('img_"+e+"').style.display = 'block'; document.getElementById('"+e+'\').muted = true;})()">\n              <source src="'+this.getVideoPath()+'" type="video/mp4">\n            </video>'},e.prototype.getTagForHtml=function(){var e="ads_"+this.response.zoneid+"_"+this.getRandomId(),t=this.getUserAgent(),n=this.getLazyLoadUrlName()||"src",i=this.isSafari(t)?"allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts":"allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation";return"<iframe\n      "+(this.needOfSandbox(t)?'sandbox="'+i+'"':"")+"\n      "+n+'="'+(1===this.response.use_adaptive_height?this.getBannertextPath(e):this.getBannertextPath(""))+'"\n      id="'+e+'"\n      name="'+e+'"\n      style="border: 0; margin: 0; overflow: hidden; resize: none;"\n      width="'+this.getWidth()+'"\n      height="'+this.getHeight()+'"\n      referrerpolicy="no-referrer-when-downgrade"\n      allowTransparency="true"></iframe>'},e.prototype.getBrowserVersion=function(e,t){var n=new RegExp(e+"/[0-9]*","").exec(t);return!!n&&n[0].slice(e.length+1)},e.prototype.isOpera=function(e){return e.indexOf("chrome")>0&&e.indexOf("safari")>0&&e.indexOf("opr/")>0},e.prototype.isChrome=function(e){return e.indexOf("chrome")>0},e.prototype.isFirefox=function(e){return e.indexOf("firefox")>0},e.prototype.isAndroid=function(e){return!(e.indexOf("windows phone")>0)&&e.indexOf("android")>0},e.prototype.isAndroidMobile=function(e){return!(e.indexOf("windows phone")>0)&&(e.indexOf("android")>0&&e.indexOf("mobile")>0)},e.prototype.isWidowsPhone=function(e){return e.indexOf("windows phone")>0},e.prototype.isIos=function(e){return e.indexOf("iphone")>0||e.indexOf("ipad")>0},e.prototype.isSp=function(e){return this.isAndroid(e)||this.isIos(e)||this.isWidowsPhone(e)},e.prototype.isSafari=function(e){return e.indexOf("safari")>0&&e.indexOf("chrome")<=0},e.prototype.isIE10=function(e){return-1!==e.indexOf("msie 10.")},e.prototype.isIE9=function(e){return-1!==e.indexOf("msie 9.")},e.prototype.isIE=function(e){return-1!==e.indexOf("trident/")&&-1!==e.indexOf("rv:11.0")||this.isIE10(e)||this.isIE9(e)},e.prototype.isEdge=function(e){return-1!==e.indexOf("edge")},e.prototype.isMicrosoft=function(e){return this.isEdge(e)||this.isIE(e)},e.prototype.needOfSandbox=function(e){if(this.isSp(e))return!1;if(this.isMicrosoft(e))return!1;var t;return this.isOpera(e)&&!1!==(t=this.getBrowserVersion("opr",e))?t>=34:this.isChrome(e)&&!1!==(t=this.getBrowserVersion("chrome",e))?t>=46:this.isFirefox(e)&&!1!==(t=this.getBrowserVersion("firefox",e))?t>=49:!(!this.isSafari(e)||!1===(t=this.getBrowserVersion("safari",e)))&&t>=604},e.prototype.getUserAgent=function(){return window.navigator.userAgent.toLowerCase()},e.prototype.getImagePath=function(){return window.Ads.pathBase+"/assets/images/"+this.response.filename},e.prototype.getVideoPath=function(){return window.Ads.resBase+"/"+this.response.filename},e.prototype.getClickPath=function(){return window.Ads.pathBase+"/click?"+i.toQueryString({bannerid:this.response.bannerid,zoneid:this.response.zoneid})},e.prototype.getBannertextPath=function(e){return window.Ads.pathBase+"/bannertext?"+i.toQueryString({bannerid:this.response.bannerid,did:window.Ads.did,frameId:e,zoneid:this.response.zoneid})},e.prototype.getWidth=function(){return null!=this.advertisement.width&&this.advertisement.width>0?this.advertisement.width:null!=this.response.width&&this.response.width>0?this.response.width:this.advertisement.getElement().offsetWidth||0},e.prototype.getHeight=function(){return null!=this.advertisement.height&&this.advertisement.height>0?this.advertisement.height:null!=this.response.width&&this.response.width>0&&null!=this.response.height&&this.response.height>0&&!0===this.advertisement.keepAspectRatio&&null!=this.advertisement.width&&this.advertisement.width>0?this.advertisement.width*this.response.height/this.response.width:null!=this.response.height&&this.response.height>0?this.response.height:this.advertisement.getElement().offsetHeight||0},e.prototype.link=function(e){return'<a href="'+this.getClickPath()+'" target="_blank" rel="noopener">'+e+"</a>"},e.prototype.isImage=function(){return"gif"===this.response.contenttype||"jpeg"===this.response.contenttype||"png"===this.response.contenttype},e.prototype.isText=function(){return"txt"===this.response.contenttype},e.prototype.hasTextLink=function(){return!this.isHtml()&&!!this.response.bannertext},e.prototype.isHtml=function(){return"html"===this.response.contenttype},e.prototype.isVideo=function(){return"mp4"===this.response.contenttype},e.prototype.isLazyLoad=function(){return!0===this.response.uselazyload},e.prototype.setResponse=function(e){this.response=e},e.prototype.setLazyLoadUrlName=function(e){this.lazyLoadUrlName=e},e.prototype.getLazyLoadUrlName=function(){return this.lazyLoadUrlName},e.prototype.getString=function(){return"function"==typeof this.advertisement.template?(this.getString=this.getTag,this.advertisement.template.apply(this)):this.getTag()},e}();t.Template=o},function(e,t,n){"use strict";n.r(t),n.d(t,"IntersectionObserver",function(){return i});const i=window.IntersectionObserver||a,r=window.document,o=[];function s(e){this.time=e.time,this.target=e.target,this.rootBounds=e.rootBounds,this.boundingClientRect=e.boundingClientRect,this.intersectionRect=e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0},this.isIntersecting=!!e.intersectionRect;const t=this.boundingClientRect,n=t.width*t.height,i=this.intersectionRect,r=i.width*i.height;this.intersectionRatio=n?Number((r/n).toFixed(4)):this.isIntersecting?1:0}function a(e,t){const n=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(n.root&&1!=n.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=function(e,t){let n=null;return function(){n||(n=setTimeout(function(){e(),n=null},t))}}(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(n.rootMargin),this.thresholds=this._initThresholds(n.threshold),this.root=n.root||null,this.rootMargin=this._rootMarginValues.map(function(e){return e.value+e.unit}).join(" ")}function l(e,t,n,i){"function"==typeof e.addEventListener?e.addEventListener(t,n,i||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,n)}function d(e,t,n,i){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,i||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,n)}function h(e,t){const n=Math.max(e.top,t.top),i=Math.min(e.bottom,t.bottom),r=Math.max(e.left,t.left),o=Math.min(e.right,t.right),s=o-r,a=i-n;return s>=0&&a>=0&&{top:n,bottom:i,left:r,right:o,width:s,height:a}}function u(e){let t;try{t=e.getBoundingClientRect()}catch(e){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function c(e,t){let n=t;for(;n;){if(n==e)return!0;n=p(n)}return!1}function p(e){const t=e.parentNode;return t&&11==t.nodeType&&t.host?t.host:t&&t.assignedSlot?t.assignedSlot.parentNode:t}a.prototype.THROTTLE_TIMEOUT=100,a.prototype.POLL_INTERVAL=null,a.prototype.USE_MUTATION_OBSERVER=!0,a.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},a.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e}),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},a.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},a.prototype.takeRecords=function(){const e=this._queuedEntries.slice();return this._queuedEntries=[],e},a.prototype._initThresholds=function(e){let t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter(function(e,t,n){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==n[t-1]})},a.prototype._parseRootMargin=function(e){const t=(e||"0px").split(/\s+/).map(function(e){const t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}});return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},a.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(l(window,"resize",this._checkForIntersections,!0),l(r,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in window&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(r,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},a.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,d(window,"resize",this._checkForIntersections,!0),d(r,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},a.prototype._checkForIntersections=function(){const e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach(function(n){const i=n.element,r=u(i),o=this._rootContainsTarget(i),a=n.entry,l=e&&o&&this._computeTargetAndRootIntersection(i,t),d=n.entry=new s({time:window.performance&&performance.now&&performance.now(),target:i,boundingClientRect:r,rootBounds:t,intersectionRect:l});a?e&&o?this._hasCrossedThreshold(a,d)&&this._queuedEntries.push(d):a&&a.isIntersecting&&this._queuedEntries.push(d):this._queuedEntries.push(d)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},a.prototype._computeTargetAndRootIntersection=function(e,t){if("none"==window.getComputedStyle(e).display)return;let n=u(e),i=p(e),o=!1;for(;!o;){let e=null;const s=1==i.nodeType?window.getComputedStyle(i):{};if("none"==s.display)return;if(i==this.root||i==r?(o=!0,e=t):i!=r.body&&i!=r.documentElement&&"visible"!=s.overflow&&(e=u(i)),e&&!(n=h(e,n)))break;i=p(i)}return n},a.prototype._getRootRect=function(){let e;if(this.root)e=u(this.root);else{const t=r.documentElement,n=r.body;e={top:0,left:0,right:t.clientWidth||n.clientWidth,width:t.clientWidth||n.clientWidth,bottom:t.clientHeight||n.clientHeight,height:t.clientHeight||n.clientHeight}}return this._expandRectByRootMargin(e)},a.prototype._expandRectByRootMargin=function(e){const t=this._rootMarginValues.map(function(t,n){return"px"==t.unit?t.value:t.value*(n%2?e.width:e.height)/100}),n={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},a.prototype._hasCrossedThreshold=function(e,t){const n=e&&e.isIntersecting?e.intersectionRatio||0:-1,i=t.isIntersecting?t.intersectionRatio||0:-1;if(n!==i)for(let e=0;e<this.thresholds.length;e++){const t=this.thresholds[e];if(t==n||t==i||t<n!=t<i)return!0}},a.prototype._rootIsInDom=function(){return!this.root||c(r,this.root)},a.prototype._rootContainsTarget=function(e){return c(this.root||r,e)},a.prototype._registerInstance=function(){o.indexOf(this)<0&&o.push(this)},a.prototype._unregisterInstance=function(){const e=o.indexOf(this);-1!=e&&o.splice(e,1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0;var i=n(0),r=n(1),o=n(3),s=n(2),a=n(7),l=function(){function e(){this.advertisement=null,this.responses=[]}return e.prototype.display=function(e,t){var n,l;this.advertisement=e,this.responses=t;for(var d=function(t){var d=new o.Template(e,t),u=d.isLazyLoad()||h.advertisement.forceLazyLoad;u&&d.setLazyLoadUrlName(h.advertisement.lazyLoadUrlName?h.advertisement.lazyLoadUrlName:"nico-ads-src");var c=d.getString();if(c){if(h.advertisement.closeableActionElementId)document.getElementById(h.advertisement.closeableActionElementId).insertAdjacentHTML("beforeend",d.getCloseableButtonHtml());if(i.updateElement(e.getElement(),c)){if(null!=c.match("<video"))document.getElementById(d.videoTagId).addEventListener("canplay",d.canPlayEventListener.bind(d));if(1===t.use_adaptive_height){var p=e.getElement().firstElementChild;p instanceof HTMLIFrameElement&&(Ads.iframeResizeRetryCounts[p.id]=0,p.onload=function(){return a.Message.postRequestMessageToIframe(p)})}}if(u){var f=null!==(n=h.advertisement.lazyLoadViewMargin)&&void 0!==n?n:"100px",m=null!==(l=h.advertisement.lazyLoadUrlName)&&void 0!==l?l:"nico-ads-src",g=e.getElement().querySelectorAll("["+m+"]");i.observationLazyLoad(g,f,m)}}1===e.impression&&(r.Api.logImpression(t.campaignid,t.bannerid,t.zoneid).catch(function(){}),r.Api.callThirdPartyTracking(t)),s.Utility.observationViewableImpression(h.advertisement,t.campaignid,t.bannerid,t.zoneid)},h=this,u=0,c=t;u<c.length;u++){d(c[u])}},e.prototype.update=function(){var e=this.advertisement.getElement();e&&e.innerHTML&&(e.innerHTML=""),this.advertisement.set(this.advertisement.elementId,this.advertisement.template)},e}();t.View=l},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.AdvertisementLoader=void 0;var r=n(0),o=n(1),s=n(20),a=n(8),l=function(){function e(){var t=this;if(this.advertisements=[],this.timer=null,this.interval=0,this.isSend=!1,this.callback=function(n){for(var i,o,s,l,d=[],h=[],u=0,c=t.advertisements;u<c.length;u++){for(var p=c[u],f=[],m=!0,g=0;g<n.length;g++)p.zone!==n[g].zoneid&&p.zone!==n[g].chainid||("nil"!==n[g].contenttype&&(m=!1),p.zoneIds&&-1!==r.indexOf(p.zoneIds,p.zone)?(h.push(n[g]),d.push(p)):f.push(n[g]),n.splice(g--,1));null!==p.eventListener&&((f.length>0||h.length>0)&&!1===m?null===(o=null===(i=p.eventListener)||void 0===i?void 0:i.render)||void 0===o||o.call(i):null===(l=null===(s=p.eventListener)||void 0===s?void 0:s.empty)||void 0===l||l.call(s)),f.length>0&&p.view.display(p,f)}h.length>0&&a.InterlockAds.display(d,h),e.unload(t)},void 0===window.Ads.loaderInterval)throw new Error("Argument Ads.loaderInterval is required");var n=parseInt(window.Ads.loaderInterval.toString(),10);if(isNaN(n))throw new Error("Argument Ads.loaderInterval must be numeric.");if(n<0)throw new Error("Argument Ads.loaderInterval must be bigger than 0.");this.interval=n}return e.register=function(t){if(Array.isArray(t.presetAds)){(new e).addPresetAds(t)}else{var n,i=e.group.length;for(n=0;n<i;n++)if(e.group[n].checkRequestGroup(t))return void e.group[n].add(t);e.group[n]=new e,e.group[n].add(t)}},e.registers=function(t){if(Array.isArray(t.presetAdsRaw)){(new e).addPresetAds(t)}else{var n,i=e.group.length;for(n=0;n<i;n++)if(e.group[n].checkRequestGroup(t))return void e.group[n].interlockAdd(t);e.group[n]=new e,e.group[n].interlockAdd(t)}},e.unload=function(t){for(var n=0;n<e.group.length;n++)e.group[n]===t&&e.group.splice(n,1)},e.prototype.add=function(e){var t=this;return!this.isSend&&(this.advertisements.push(e),this.timer||(this.timer=window.setTimeout(function(){t.isSend=!0,t.send()},this.interval)),!0)},e.prototype.embedInterlockInfo=function(e,t){var n,r,o,s=e.elementIds[t];return i(i({},e),{zone:e.zoneIds[t],elementId:s,template:e.templates[t],eventListener:e.eventListeners[t],getElement:function(){return document.getElementById(s)},closeableActionElementId:null!==(n=e.closeableActionElementIds[t])&&void 0!==n?n:void 0,closeableButtonText:null!==(r=e.closeableButtonTexts[t])&&void 0!==r?r:["広告を閉じる","広告を表示"],forceLazyLoad:null!==(o=e.forceLazyLoads[t])&&void 0!==o&&o,lazyLoadViewMargin:e.lazyLoadViewMargins[t],lazyLoadUrlName:e.lazyLoadUrlNames[t],viewImpThreshold:e.viewImpThresholds[t],viewImpDelay:e.viewImpDelays[t]})},e.prototype.addPresetAds=function(e){var t={data:[]};if(e instanceof a.InterlockAds){for(var n=e.zoneIds.length,i=0;i<n;i++)if(Array.isArray(e.presetAds[i])&&e.presetAds[i].length&&(e.zoneIds[i]===e.presetAds[i][0].zoneid||e.zoneIds[i]===e.presetAds[i][0].chainid)){var r=this.embedInterlockInfo(e,i);this.advertisements.push(r),t.data.push(e.presetAds[i][0])}this.callback(t.data)}else if(Array.isArray(e.presetAds)&&e.presetAds.length&&e.zone===e.presetAds[0].zoneid||e.zone===e.presetAds[0].chainid){this.advertisements.push(e);var o={data:[e.presetAds[0]]};this.callback(o.data)}},e.prototype.interlockAdd=function(e){for(var t=e.zoneIds.length,n=0;n<t;n++){var i=this.embedInterlockInfo(e,n);this.add(i)}},e.prototype.checkRequestGroup=function(e){if(this.isSend)return!1;for(var t=0,n=this.advertisements;t<n.length;t++){var i=n[t],o=i.zoneIds||[i.zone],a=e.zoneIds||[e.zone];if(r.hasIntersection(o,a))return!1}var l=new s.AdvertisementAssembler(this.advertisements),d=new s.AdvertisementAssembler([e]);if(l.isAll()!==d.isAll())return!1;if(null!==l.impression&&l.impression!==d.impression)return!1;if(0!==this.advertisements.length){if(r.count(l.segments)!==r.count(d.segments))return!1;for(var h in l.segments)if(!d.segments[h]||d.segments[h]!==l.segments[h])return!1}return!0},e.prototype.send=function(){var e=this;this.timer=null;var t=new s.AdvertisementAssembler(this.advertisements),n=t.getZone(),i=t.segments;(t.isAll()?o.Api.getAllAdvertisements:2===t.impression?o.Api.getAdvertisementsAndLogImpression:o.Api.getAdvertisements)(n,i).then(this.callback).catch(function(){for(var t,n,i=0,r=e.advertisements;i<r.length;i++){null===(n=null===(t=r[i].eventListener)||void 0===t?void 0:t.empty)||void 0===n||n.call(t)}})},e.group=[],e}();t.AdvertisementLoader=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Message=void 0;var i=function(){function e(){}return e.postRequestMessageToIframe=function(e){null!=e.contentWindow&&void 0!==e.contentWindow.postMessage&&e.hasAttribute("src")&&e.contentWindow.postMessage('{"type": "request"}',window.Ads.pathBase)},e.resolveMessage=function(e,t){this.isResizePostMessage(t)&&this.resolveResizeMessage(e,t),this.isResponsePostMessage(t)&&this.resolveResponseMessage(e,t)},e.isResponsePostMessage=function(e){return"object"==typeof e&&"response"===e.type&&"string"==typeof e.frameId&&"number"==typeof e.height},e.isResizePostMessage=function(e){return"object"==typeof e&&"resize"===e.type&&"number"==typeof e.height&&"number"==typeof e.width},e.resolveResizeMessage=function(e,t){var n=Array.from(document.getElementsByTagName("iframe")).filter(function(t){return t.contentWindow===e})[0];n&&(n.width=t.width.toString(),n.height=t.height.toString())},e.resolveResponseMessage=function(t,n){if(n.frameId in window.Ads.iframeResizeRetryCounts){var i=document.getElementById(n.frameId);if(i instanceof HTMLIFrameElement)if(n.height>600&&(n.height=600),i.height<n.height.toString()&&600===n.height){i.height=n.height.toString();var r=i.parentElement.id,o=document.getElementById(r),s=void 0;try{s=new CustomEvent("inner_height_changed",{detail:n.frameId})}catch(e){(s=document.createEvent("CustomEvent")).initCustomEvent("inner_height_changed",!1,!1,n.frameId)}o.dispatchEvent(s)}else window.Ads.iframeResizeRetryCounts[n.frameId]<100&&(window.Ads.iframeResizeRetryCounts[n.frameId]++,window.setTimeout(e.postRequestMessageToIframe,150,i))}},e}();t.Message=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InterlockAds=void 0;var i=n(0),r=n(9),o=n(10),s=n(6),a=n(5),l=function(){function e(e){var t,n,i,s,l,d,h,u,c,p,f;this.zone=null,this.elementId=null,this.zoneIds=[],this.elementIds=[],this.templates=[],this.eventListeners=[],this.sidewall=[],this.sidewallElementIds=[],this.closeableActionElementIds=[],this.closeableButtonTexts=[],this.forceLazyLoads=[],this.lazyLoadViewMargins=[],this.lazyLoadUrlNames=[],this.viewImpThresholds=[],this.viewImpDelays=[],this.count=1,this.view=new a.View,this.time=(new Date).getTime()+Math.floor(1e6*Math.random()),this.advertisements=e.advertisements||[];var m=new r.PresetAdvertisementSet(e.presetAds);this.presetAdsRaw=m.getPresetAds(),this.presetAds=[],this.segments=e.segments||{},this.impression="number"==typeof e.impression?e.impression:1,this.contentsWidth="number"==typeof e.contentsWidth?e.contentsWidth:0,this.activatesAdjust="boolean"!=typeof e.activatesAdjust||e.activatesAdjust;for(var g=0,v=this.advertisements;g<v.length;g++){if(null!=(null===(t=(L=v[g]).eventListeners)||void 0===t?void 0:t.render)&&"function"!=typeof L.eventListeners.render)throw new Error("render must be a function.")}for(var y=0,w=this.advertisements;y<w.length;y++){if(null!=(null===(n=(L=w[y]).eventListeners)||void 0===n?void 0:n.empty)&&"function"!=typeof L.eventListeners.empty)throw new Error("empty must be a function.")}if(Array.isArray(this.presetAdsRaw))for(var A=this.presetAdsRaw.concat(),b=0,I=this.advertisements;b<I.length;b++){(L=I[b]).presetAds=[];for(var E=0;E<A.length;E++)if(A[E].zoneid===L.zoneId||A[E].chainid===L.zoneId){L.presetAds.push(A[E]),A.splice(E,1);break}}for(var _=0,T=this.advertisements;_<T.length;_++){var L=T[_];this.zoneIds.push(L.zoneId),this.elementIds.push(L.elementId),this.templates.push(L.template),this.eventListeners.push(null!==(i=L.eventListeners)&&void 0!==i?i:null),L.sidewall&&(this.sidewall.push(L.zoneId),this.sidewallElementIds.push(L.elementId)),this.presetAds.push(null!==(s=L.presetAds)&&void 0!==s?s:null),this.closeableActionElementIds.push(null!==(l=L.closeableActionElementId)&&void 0!==l?l:null),this.closeableButtonTexts.push(null!==(d=L.closeableButtonText)&&void 0!==d?d:null),this.forceLazyLoads.push(null!==(h=L.forceLazyLoad)&&void 0!==h&&h),this.lazyLoadViewMargins.push(null!==(u=L.lazyLoadViewMargin)&&void 0!==u?u:null),this.lazyLoadUrlNames.push(null!==(c=L.lazyLoadUrlName)&&void 0!==c?c:null),this.viewImpThresholds.push(null!==(p=L.viewImpThreshold)&&void 0!==p?p:null),this.viewImpDelays.push(null!==(f=L.viewImpDelay)&&void 0!==f?f:null)}2===this.sidewall.length&&2===this.sidewallElementIds.length&&o.Sidewall.setParameters({zoneIds:this.sidewall,locations:this.sidewallElementIds,contentsWidth:this.contentsWidth,segments:this.segments,impression:this.impression,activatesAdjust:this.activatesAdjust,time:this.time})}return e.display=function(t,n){if(i.canPlayMp4()||!n.some(function(e){return"mp4"===e.contenttype})){for(var r=e.categorizeAdvertisement(t,n),s=r.stdAds,a=s.length,l=r.sidewallAds,d=a-1;d>=0;d--)s.instances[d].view.display(s.instances[d],[s.adData[d]]);2===l.adData.length&&(o.Sidewall.setAdjust(),o.Sidewall.callback(l.adData))}},e.categorizeAdvertisement=function(e,t){for(var n={stdAds:{instances:[],adData:[],length:0},sidewallAds:{instances:[],adData:[],length:0}},r=t.length,o=0;o<r;o++)e[o].sidewall&&-1!==i.indexOf(e[o].sidewall,e[o].zone)?(n.sidewallAds.instances.push(e[o]),n.sidewallAds.adData.push(t[o]),n.sidewallAds.length++):(n.stdAds.instances.push(e[o]),n.stdAds.adData.push(t[o]),n.stdAds.length++);return n},e.prototype.set=function(){s.AdvertisementLoader.registers(this)},e.prototype.getElement=function(){return document.getElementById(this.elementId)},e}();t.InterlockAds=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PresetAdvertisementSet=void 0;var i=function(){function e(e){this.presetAdsString=null,this.presetAds=null;try{var t=JSON.parse(e);Array.isArray(t)&&(this.presetAds=t,this.presetAdsString=e)}catch(e){}}return e.prototype.getPresetAds=function(){return this.presetAds},e.prototype.getPresetAdsString=function(){return this.presetAdsString},e.prototype.isNull=function(){return null===this.presetAds},e}();t.PresetAdvertisementSet=i},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},s=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i};Object.defineProperty(t,"__esModule",{value:!0}),t.Sidewall=t.SidewallClass=void 0;var a=n(0),l=n(1),d=n(11),h=n(12),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.EVENT_SET_DEFERRED_TIMER="SET_DEFERRED_TIMER",t.EVENT_INVOKE_VIEW_DISPLAY="INVOKE_VIEW_DISPLAY",t.zoneIds=null,t.elementIds=null,t.adContainers=[],t.adContainerWidth=0,t.adContainerHeight=0,t.count=1,t.isInterlock=!0,t.view=null,t.segments=null,t.impression=null,t.activatesAdjust=null,t.contentsWidth=0,t.margin=0,t.eventListener=null,t.presetAds=null,t.deferredSettings={active:!1,deferredTimes:[],marginTimeBefore:300,marginTimeAfter:300,randomCoefficient:240,useDeferredTimeRange:{start:"20:00",end:"23:59"},deferredProbability:.5},t.callback=function(e){var n,i,r,o;if(0!==e.length&&e.length%2==0){t.setMaxWidth(e),t.setMaxHeight(e),t.activatesAdjust&&t.adjust();for(var s=e.splice(0,e.length/2),l=[],d=e,h=a.map(d,function(e){return e.interlock_campaign_id}),u=[],c=0,p=a.map(s,function(e){return e.campaignid});c<p.length;c++){var f=p[c];-1===a.indexOf(h,f)&&u.push(f)}var m=[];s.forEach(function(e,t){m[e.campaignid]=t});for(var g=0,v=d;g<v.length;g++){var y=v[g];if(0==y.interlock_campaign_id){var w=u.shift(),A=m[w];l.push(s[A])}else for(var b=0,I=s;b<I.length;b++){var E=I[b];if(y.interlock_campaign_id==E.campaignid){l.push(E);break}}}for(var _={left:t.getExtendedSidewall(0),right:t.getExtendedSidewall(1)},T=!0,L=0,O=[l,d];L<O.length;L++)for(var S=0,R=O[L];S<R.length;S++){if("nil"!==R[S].contenttype){T=!1;break}}T?null===(i=null===(n=t.eventListener)||void 0===n?void 0:n.empty)||void 0===i||i.call(n):null===(o=null===(r=t.eventListener)||void 0===r?void 0:r.render)||void 0===o||o.call(r);var x={left:l,right:d},P=t.deferredSettings,M=new Date,z=(M.getHours()<10?"0"+M.getHours():M.getHours())+":"+(M.getMinutes()<10?"0"+M.getMinutes():M.getMinutes()),N=P.useDeferredTimeRange,C=!1;if(N.end<N.start?(N.start<=z||z<=N.end)&&(C=!0):N.start<=z&&z<=N.end&&(C=!0),P.active&&C){for(var V=!1,B=0,F=P.deferredTimes;B<F.length;B++){var k=F[B],D="number"==typeof k.marginTimeBefore?k.marginTimeBefore:P.marginTimeBefore,j="number"==typeof k.marginTimeAfter?k.marginTimeAfter:P.marginTimeAfter,H="number"==typeof k.randomCoefficient?k.randomCoefficient:P.randomCoefficient,W="number"==typeof k.deferredProbability&&k.deferredProbability>0&&k.deferredProbability<=1?k.deferredProbability:P.deferredProbability,U=k.time-D,q=k.time+j,Y=(new Date).getTime()/1e3,K=Math.random()*H*1e3;if(U<=Y&&Y<q&&Math.random()<W){t.fireEvent(t.EVENT_SET_DEFERRED_TIMER,K),window.setTimeout(function(){t.fireEvent(t.EVENT_INVOKE_VIEW_DISPLAY),t.view.display(_,x)},K),V=!0;break}}V||(t.fireEvent(t.EVENT_INVOKE_VIEW_DISPLAY),t.view.display(_,x))}else t.fireEvent(t.EVENT_INVOKE_VIEW_DISPLAY),t.view.display(_,x)}},t}return r(t,e),t.prototype.setParameters=function(e){var t;if(this.adContainerWidth=0,this.adContainerHeight=0,this.zoneIds=s(e.zoneIds),this.elementIds=s(e.locations),2!==this.zoneIds.length||2!==this.elementIds.length)throw new Error("zoneIds and locations need both left and right.");if(this.impression="number"==typeof e.impression?e.impression:1,this.segments=e.segments||{},this.activatesAdjust="boolean"!=typeof e.activatesAdjust||e.activatesAdjust,this.adContainers=[document.getElementById(this.elementIds[0]),document.getElementById(this.elementIds[1])],this.contentsWidth=e.contentsWidth,this.margin=e.margin||0,this.eventListener=e.eventListeners||null,this.presetAds=e.presetAds||null,this.viewImpThreshold="number"==typeof e.viewImpThreshold?e.viewImpThreshold:null,this.viewImpDelay="number"==typeof e.viewImpDelay?e.viewImpDelay:null,null!==this.presetAds){var n=[];try{n=JSON.parse(this.presetAds)}catch(e){throw new Error("invalid json format.")}if(2!=n.length)throw new Error("The left and right zone presetAds arguments must be specified at the same time.")}if("object"==typeof e.deferredSettings){var i=e.deferredSettings;"boolean"==typeof i.active&&(this.deferredSettings.active=i.active),"number"==typeof i.marginTimeBefore&&(this.deferredSettings.marginTimeBefore=i.marginTimeBefore),"number"==typeof i.marginTimeAfter&&(this.deferredSettings.marginTimeAfter=i.marginTimeAfter),"number"==typeof i.randomCoefficient&&(this.deferredSettings.randomCoefficient=i.randomCoefficient);for(var r=[].concat(i.deferredTimes||[]),o=0,a=r;o<a.length;o++){var l=a[o];if("object"!=typeof l||"number"!=typeof l.time||"string"!=typeof l.id)throw new Error("Argument deferredTimes must be object. Argument deferredTimes[].time must be number. Argument deferredTimes[].id must be string.")}if(this.deferredSettings.deferredTimes=r,"object"==typeof i.useDeferredTimeRange){var d=i.useDeferredTimeRange;if(!("string"==typeof d.start&&null!==d.start.match(/^[0-2][0-9]:[0-5][0-9]$/)&&d.start<"24:00"))throw new Error('Argument useDeferredTimeRange.start must be match this pattern "^[0-2][0-9]:[0-5][0-9]$".');if(this.deferredSettings.useDeferredTimeRange.start=d.start,!("string"==typeof d.end&&null!==d.end.match(/^[0-2][0-9]:[0-5][0-9]$/)&&d.end<"24:00"))throw new Error('Argument useDeferredTimeRange.end must be match this pattern "^[0-2][0-9]:[0-5][0-9]$".');this.deferredSettings.useDeferredTimeRange.end=d.end}if("number"==typeof i.deferredProbability){if(!(i.deferredProbability>0&&i.deferredProbability<=1))throw new Error("Argument deferredProbability must be more than 0");this.deferredSettings.deferredProbability=i.deferredProbability}}if(this.deferredSettings.useDeferredTimeRange.start===this.deferredSettings.useDeferredTimeRange.end)throw new Error("Argument useDeferredTimeRange.start and useDeferredTimeRange.end must be set to a different value. If want to enable all day, please set useDeferredTimeRange {'00:00','23:59'}");if(this.count="number"==typeof e.count?e.count:1,this.view=(null===(t=e.view)||void 0===t?void 0:t.display)?e.view:new h.SidewallView,this.count!==window.Ads.ALL&&1!==this.count)throw new Error("Argument count must be numeric 1 or Ads.ALL(-1).");if(this.count===window.Ads.ALL&&2===this.impression)throw new Error("You can not set [count: ALL] and [impression: 2] at a time.")},t.prototype.adjust=function(){this.adContainers[0].style.width="0",this.adContainers[1].style.width="0";var e=Math.max(document.documentElement.clientWidth,document.body.clientWidth)-this.contentsWidth;if(!(e<=0)){var t=Math.floor(e/2),n=Math.min(t,this.adContainerWidth),i=n+this.margin;this.adContainers[0].style.display="block",this.adContainers[0].style.width=n+"px",this.adContainers[0].style.left=-i+"px",this.adContainers[1].style.display="block",this.adContainers[1].style.width=n+"px",this.adContainers[1].style.right=-i+"px"}},t.prototype.setAdjust=function(){var e=this;this.activatesAdjust&&(a.addEvent(window,"resize",function(){return e.adjust()}),this.adjust())},t.prototype.invoke=function(){var e,t,n=this;if(this.setAdjust(),null!=(null===(e=this.eventListener)||void 0===e?void 0:e.render)&&"function"!=typeof this.eventListener.render)throw new Error("render must be a function.");if(null!=(null===(t=this.eventListener)||void 0===t?void 0:t.empty)&&"function"!=typeof this.eventListener.empty)throw new Error("empty must be a function.");if(null===this.presetAds){(this.count===window.Ads.ALL?l.Api.getAllAdvertisements:2===this.impression?l.Api.getAdvertisementsAndLogImpression:l.Api.getAdvertisements)(this.zoneIds,this.segments).then(this.callback).catch(function(){var e,t;null===(t=null===(e=n.eventListener)||void 0===e?void 0:e.empty)||void 0===t||t.call(e)})}else{var i={data:JSON.parse(this.presetAds)};if(2===this.impression)for(var r=0,o=i.data;r<o.length;r++){var s=o[r];l.Api.logImpression(s.campaignid,s.bannerid,s.zoneid).catch(function(){}),l.Api.callThirdPartyTracking(s)}this.callback(i.data)}},t.prototype.setMaxWidth=function(e){var t=e.map(function(e){return e.width});this.adContainerWidth=Math.max.apply(Math,s([0],t))},t.prototype.setMaxHeight=function(e){var t=e.map(function(e){return e.height});this.adContainerHeight=Math.max.apply(Math,s([0],t))},t.prototype.getExtendedSidewall=function(e){return o(o({},this),{getElement:function(){return this.adContainers[e]}})},t.prototype.logImpressionCallback=function(e){if(e.message)throw new Error(e.message)},t}(d.EventManager);t.SidewallClass=u,t.Sidewall=new u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventManager=void 0;var i=function(){function e(){this.definedEvents={}}return e.prototype.addListener=function(e,t,n){void 0===this.definedEvents[e]&&(this.definedEvents[e]=[]),n=n||this,this.definedEvents[e].push({func:t,scope:n})},e.prototype.fireEvent=function(e){for(var t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];for(var r=0,o=null!==(t=this.definedEvents[e])&&void 0!==t?t:[];r<o.length;r++){var s=o[r];s.func.apply(s.scope,n)}},e.prototype.removeListener=function(e,t){var n;this.definedEvents[e]=null===(n=this.definedEvents[e])||void 0===n?void 0:n.filter(function(e){return e.func!==t})},e}();t.EventManager=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SidewallView=void 0;var i=n(0),r=n(1),o=n(21),s=n(3),a=n(2),l=function(){function e(){this.frequency=new o.Frequency}return e.prototype.display=function(e,t){e.left&&e.right&&t.left&&t.right&&t.left.length===t.right.length&&(this.setAd(e.left,t.left[0]),this.setAd(e.right,t.right[0]))},e.prototype.setAd=function(e,t){if(this.frequency.checkFrequency(t)){if(!i.updateElement(e.getElement(),new s.Template(e,t).getString()))return;1===e.impression&&(r.Api.logImpression(t.campaignid,t.bannerid,t.zoneid).catch(function(){}),r.Api.callThirdPartyTracking(t)),a.Utility.observationViewableImpression(e,t.campaignid,t.bannerid,t.zoneid),t.optional&&(document.body.style.backgroundColor=t.optional)}},e}();t.SidewallView=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Follow=void 0;var i=n(0),r=n(2),o=function(){function e(t,n,r){var o=e.followBaseName+t,s=document.getElementById(t),a=i.cumulativeOffset(s);if(e.containers[o]={follower:s,margin:n||0,bottom:r||0,left:a.left,top:a.top},!e.containers[o].follower)throw new Error(t+" is not found.");if(n&&"number"!=typeof n)throw new Error("margin is not number.");if(r&&"number"!=typeof r)throw new Error("bottom is not number.");i.addEvent(window,"scroll",function(){return e.fix(o)},!1),i.addEvent(window,"resize",function(){return e.resize(o)},!1)}return e.locate=function(t,n){var i=r.Utility.getScroll(),o=e.containers[t];o.top-o.margin<i.top?o.bottom-o.follower.clientHeight-o.margin>i.top?(o.follower.style.position="fixed",o.follower.style.top=o.margin+"px",o.follower.style.left=n.left+"px"):(o.follower.style.position="absolute",o.follower.style.top=o.bottom-o.follower.clientHeight+"px",o.follower.style.left=n.left+"px"):(o.follower.style.position="static",n.top>o.top&&(o.top=n.top))},e.fix=function(t){var n=i.cumulativeOffset(e.containers[t].follower);e.locate(t,n)},e.resize=function(t){e.containers[t].follower.style.position="static";var n=i.cumulativeOffset(e.containers[t].follower);e.locate(t,n)},e.setMargin=function(t,n){e.containers[e.followBaseName+t]&&(e.containers[e.followBaseName+t].margin=n)},e.setBottom=function(t,n){e.containers[e.followBaseName+t]&&(e.containers[e.followBaseName+t].bottom=n)},e.followBaseName="ads_follow_",e.containers={},e}();t.Follow=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(15),r=n(2);window.Ads=i.Ads,r.Utility.setup()},function(e,t,n){"use strict";var i,r,o,s,a;Object.defineProperty(t,"__esModule",{value:!0}),t.Ads=void 0;var l=n(16),d=n(13),h=n(8),u=n(10),c=n(12),p=n(22),f=n(24),m=n(5),g=n(0),v="https:"===((null===(i=window.Ads)||void 0===i?void 0:i.protocol)||location.protocol)?"https:":"http:",y=v+"//ads.nicovideo.jp",w=v+"//res.ads.nicovideo.jp",A=g.getMetaTagContent("ads-pagevariant"),b=g.getMetaTagContent("ads-loaderinterval");t.Ads={Advertisement:l.Advertisement,Follow:d.Follow,InterlockAds:h.InterlockAds,Sidewall:u.Sidewall,SidewallSwitchView:p.SidewallSwitchView,SidewallView:c.SidewallView,SwitchView:f.SwitchView,View:m.View,protocol:v,pathBase:(null===(r=window.Ads)||void 0===r?void 0:r.pathBase)||y,resBase:(null===(o=window.Ads)||void 0===o?void 0:o.resBase)||w,ALL:-1,version:"2.32.8.fa0ef225945dc3391d0cfec4c6bd567d17ef12b1",buildDate:"20220621",isDebugMode:!1,removeLoadedSctipt:!0,iframeResizeRetryCounts:{},pageUrl:(null===(s=window.Ads)||void 0===s?void 0:s.pageUrl)||"",pageVariant:A||"",loaderInterval:parseInt(b,10)||500,did:(null===(a=window.Ads)||void 0===a?void 0:a.did)||null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Advertisement=void 0;var i=n(6),r=n(9),o=n(13),s=n(5),a=function(){function e(e){var t,n,i=this;if(this.elementId=null,this.template=null,this.adsize=null,this.landscapeFlag=!1,this.closeableButtonText=["広告を閉じる","広告を表示"],"number"!=typeof e.zone)throw new Error("zone is not number.");this.zone=e.zone,this.segments=e.segments||{},this.count="number"==typeof e.count?e.count:1,this.impression="number"==typeof e.impression?e.impression:1,this.view=e.view&&e.view.display?e.view:new s.View,this.follow=e.follow||null,this.eventListener="eventListeners"in e?e.eventListeners:null,this.migiue="string"==typeof e.migiue?e.migiue:null,this.closeableActionElementId="string"==typeof e.closeableActionElementId?e.closeableActionElementId:null,null!==this.closeableActionElementId&&"object"==typeof e.closeableButtonText&&2===e.closeableButtonText.length&&(this.closeableButtonText=e.closeableButtonText);var o=new r.PresetAdvertisementSet(e.presetAds);if(this.presetAds=o.getPresetAds(),this.forceLazyLoad="boolean"==typeof e.forceLazyLoad&&e.forceLazyLoad,this.lazyLoadViewMargin="string"==typeof e.lazyLoadViewMargin?e.lazyLoadViewMargin:null,this.lazyLoadUrlName="string"==typeof e.lazyLoadUrlName?e.lazyLoadUrlName:null,this.viewImpThreshold="number"==typeof e.viewImpThreshold?e.viewImpThreshold:null,this.viewImpDelay="number"==typeof e.viewImpDelay?e.viewImpDelay:null,null!=(null===(t=this.eventListener)||void 0===t?void 0:t.render)&&"function"!=typeof this.eventListener.render)throw new Error("render must be a function.");if(null!=(null===(n=this.eventListener)||void 0===n?void 0:n.empty)&&"function"!=typeof this.eventListener.empty)throw new Error("empty must be a function.");if(this.count===Ads.ALL&&2===this.impression)throw new Error("You can not set [count: ALL] and [impression: 2] at a time.");this.width="number"==typeof e.width?e.width:null,this.height="number"==typeof e.height?e.height:null,this.keepAspectRatio="boolean"!=typeof e.keepAspectRatio||e.keepAspectRatio,this.adsize="object"==typeof e.size?this.adsize=e.size:this.adsize,null!==this.adsize&&window.setInterval(function(){var e,t=null===(e=screen.orientation)||void 0===e?void 0:e.angle;(90===t||270===t)!=i.landscapeFlag&&i.update()},1e3)}return e.prototype.update=function(){var e,t,n,i;document.getElementById(this.elementId)&&(90===screen.orientation.angle||270===screen.orientation.angle?(this.resize(null===(e=this.adsize.landscape)||void 0===e?void 0:e.width,null===(t=this.adsize.landscape)||void 0===t?void 0:t.height),this.landscapeFlag=!0):(this.resize(null===(n=this.adsize.portrait)||void 0===n?void 0:n.width,null===(i=this.adsize.portrait)||void 0===i?void 0:i.height),this.landscapeFlag=!1))},e.prototype.set=function(e,t){var n,r,s,a,l,d,h,u,c,p,f,m,g=this,v=document.getElementById(e);if(!v)throw new Error(e+" is not found.");if(this.getElement=function(){return v},t&&"function"!=typeof t)throw new Error("template is not function.");var y=!1;return null!==this.adsize&&(void 0===screen.orientation?(y=!0,this.width=Math.min(null===(n=this.adsize.landscape)||void 0===n?void 0:n.width,null===(r=this.adsize.portrait)||void 0===r?void 0:r.width),this.height=Math.min(null===(s=this.adsize.landscape)||void 0===s?void 0:s.height,null===(a=this.adsize.portrait)||void 0===a?void 0:a.height)):(90===screen.orientation.angle||270===screen.orientation.angle?(this.width=null===(l=this.adsize.landscape)||void 0===l?void 0:l.width,this.height=null===(d=this.adsize.landscape)||void 0===d?void 0:d.height,this.landscapeFlag=!0):(this.width=null===(h=this.adsize.portrait)||void 0===h?void 0:h.width,this.height=null===(u=this.adsize.portrait)||void 0===u?void 0:u.height),(null===(c=this.adsize.portrait)||void 0===c?void 0:c.width)===(null===(p=this.adsize.landscape)||void 0===p?void 0:p.width)&&(null===(f=this.adsize.landscape)||void 0===f?void 0:f.height)===(null===(m=this.adsize.portrait)||void 0===m?void 0:m.height)&&(y=!0))),this.elementId=e,this.template=t,i.AdvertisementLoader.register(this),this.follow&&new o.Follow(this.follow.elementId||this.elementId,this.follow.margin,this.follow.bottom),null!==this.adsize&&(y||window.addEventListener("orientationchange",function(){g.update()})),this},e.prototype.getElement=function(){var e=document.getElementById(this.elementId);return e&&(this.getElement=function(){return e}),e},e.prototype.resize=function(e,t){for(var n,i=document.getElementById(this.elementId),r=0,o=Array.from(i.children);r<o.length;r++){var s=o[r];if(s instanceof HTMLDivElement&&(s=null!==(n=s.firstElementChild)&&void 0!==n?n:s),s instanceof HTMLAnchorElement&&s.firstElementChild instanceof HTMLImageElement)s.firstElementChild.width=e,s.firstElementChild.height=t;else if(s instanceof HTMLIFrameElement){s.width=e.toString(),s.height=t.toString();break}}this.width=e,this.height=t},e}();t.Advertisement=a},function(e,t,n){(function(t,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var i;i=function(){"use strict";function e(e){return"function"==typeof e}var i=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,o=void 0,s=void 0,a=function(e,t){f[r]=e,f[r+1]=t,2===(r+=2)&&(s?s(m):A())},l="undefined"!=typeof window?window:void 0,d=l||{},h=d.MutationObserver||d.WebKitMutationObserver,u="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),c="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){var e=setTimeout;return function(){return e(m,1)}}var f=new Array(1e3);function m(){for(var e=0;e<r;e+=2){(0,f[e])(f[e+1]),f[e]=void 0,f[e+1]=void 0}r=0}var g,v,y,w,A=void 0;function b(e,t){var n=this,i=new this.constructor(_);void 0===i[E]&&B(i);var r=n._state;if(r){var o=arguments[r-1];a(function(){return C(r,i,o,n._result)})}else z(n,i,e,t);return i}function I(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(_);return R(t,e),t}u?A=function(){return t.nextTick(m)}:h?(v=0,y=new h(m),w=document.createTextNode(""),y.observe(w,{characterData:!0}),A=function(){w.data=v=++v%2}):c?((g=new MessageChannel).port1.onmessage=m,A=function(){return g.port2.postMessage(0)}):A=void 0===l?function(){try{var e=Function("return this")().require("vertx");return void 0!==(o=e.runOnLoop||e.runOnContext)?function(){o(m)}:p()}catch(e){return p()}}():p();var E=Math.random().toString(36).substring(2);function _(){}var T=void 0,L=1,O=2;function S(t,n,i){n.constructor===t.constructor&&i===b&&n.constructor.resolve===I?function(e,t){t._state===L?P(e,t._result):t._state===O?M(e,t._result):z(t,void 0,function(t){return R(e,t)},function(t){return M(e,t)})}(t,n):void 0===i?P(t,n):e(i)?function(e,t,n){a(function(e){var i=!1,r=function(e,t,n,i){try{e.call(t,n,i)}catch(e){return e}}(n,t,function(n){i||(i=!0,t!==n?R(e,n):P(e,n))},function(t){i||(i=!0,M(e,t))},e._label);!i&&r&&(i=!0,M(e,r))},e)}(t,n,i):P(t,n)}function R(e,t){if(e===t)M(e,new TypeError("You cannot resolve a promise with itself"));else if(r=typeof(i=t),null===i||"object"!==r&&"function"!==r)P(e,t);else{var n=void 0;try{n=t.then}catch(t){return void M(e,t)}S(e,t,n)}var i,r}function x(e){e._onerror&&e._onerror(e._result),N(e)}function P(e,t){e._state===T&&(e._result=t,e._state=L,0!==e._subscribers.length&&a(N,e))}function M(e,t){e._state===T&&(e._state=O,e._result=t,a(x,e))}function z(e,t,n,i){var r=e._subscribers,o=r.length;e._onerror=null,r[o]=t,r[o+L]=n,r[o+O]=i,0===o&&e._state&&a(N,e)}function N(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var i=void 0,r=void 0,o=e._result,s=0;s<t.length;s+=3)i=t[s],r=t[s+n],i?C(n,i,r,o):r(o);e._subscribers.length=0}}function C(t,n,i,r){var o=e(i),s=void 0,a=void 0,l=!0;if(o){try{s=i(r)}catch(e){l=!1,a=e}if(n===s)return void M(n,new TypeError("A promises callback cannot return that same promise."))}else s=r;n._state!==T||(o&&l?R(n,s):!1===l?M(n,a):t===L?P(n,s):t===O&&M(n,s))}var V=0;function B(e){e[E]=V++,e._state=void 0,e._result=void 0,e._subscribers=[]}var F=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(_),this.promise[E]||B(this.promise),i(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?P(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&P(this.promise,this._result))):M(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===T&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,i=n.resolve;if(i===I){var r=void 0,o=void 0,s=!1;try{r=e.then}catch(e){s=!0,o=e}if(r===b&&e._state!==T)this._settledAt(e._state,t,e._result);else if("function"!=typeof r)this._remaining--,this._result[t]=e;else if(n===k){var a=new n(_);s?M(a,o):S(a,e,r),this._willSettleAt(a,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(i(e),t)},e.prototype._settledAt=function(e,t,n){var i=this.promise;i._state===T&&(this._remaining--,e===O?M(i,n):this._result[t]=n),0===this._remaining&&P(i,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;z(e,void 0,function(e){return n._settledAt(L,t,e)},function(e){return n._settledAt(O,t,e)})},e}(),k=function(){function t(e){this[E]=V++,this._result=this._state=void 0,this._subscribers=[],_!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t(function(t){R(e,t)},function(t){M(e,t)})}catch(t){M(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var n=this.constructor;return e(t)?this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){throw e})}):this.then(t,t)},t}();return k.prototype.then=b,k.all=function(e){return new F(this,e).promise},k.race=function(e){var t=this;return i(e)?new t(function(n,i){for(var r=e.length,o=0;o<r;o++)t.resolve(e[o]).then(n,i)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},k.resolve=I,k.reject=function(e){var t=new this(_);return M(t,e),t},k._setScheduler=function(e){s=e},k._setAsap=function(e){a=e},k._asap=a,k.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var i=null;try{i=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===i&&!t.cast)return}e.Promise=k},k.Promise=k,k},e.exports=i()}).call(this,n(18),n(19))},function(e,t){var n,i,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var l,d=[],h=!1,u=-1;function c(){h&&l&&(h=!1,l.length?d=l.concat(d):u=-1,d.length&&p())}function p(){if(!h){var e=a(c);h=!0;for(var t=d.length;t;){for(l=d,d=[];++u<t;)l&&l[u].run();u=-1,t=d.length}l=null,h=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new f(e,t)),1!==d.length||h||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.AdvertisementAssembler=void 0;var r=n(0),o=function(){function e(e){this.impression=null,this.all=!1,this.parameters={zone:[]},this.segments={},this.presetData=!1;for(var t=0,n=e;t<n.length;t++){var o=n[t];this.all||(this.all=o.count===window.Ads.ALL);for(var s=0;s<(o.count===window.Ads.ALL?1:o.count);s++)this.parameters.zone=this.parameters.zone.concat(o.zone);null===this.impression&&(this.impression=o.impression),this.presetData||o.presetAds&&(this.presetData=!0),0!==r.count(o.segments)&&(this.segments=i(i({},this.segments),o.segments))}}return e.prototype.isAll=function(){return this.all},e.prototype.getZone=function(){return r.deleteEmptyFromArray(this.parameters.zone)},e}();t.AdvertisementAssembler=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Frequency=void 0;var i=n(0),r=function(){function e(){this.checked=!1,this.display=!1}return e.prototype.checkFrequency=function(e){return this.checked||(e.views<0?this.display=!0:this.getFrequency(e.campaignid)<e.views&&(this.display=!0,this.logFrequency(e.campaignid)),this.checked=!0),this.display},e.prototype.getCampaigns=function(){for(var e=0,t=document.cookie.split(";");e<t.length;e++){var n=t[e];if(n.match(/^\s*nicoads_fc/))return i.deleteEmptyFromArray(n.replace(/^\s*nicoads_fc=/,"").split("|"))}return[]},e.prototype.getFrequency=function(e){for(var t=0,n=this.getCampaigns();t<n.length;t++){var i=n[t];if(i.match("^"+e+"="))return parseInt(i.split("=")[1],10)}return 0},e.prototype.logFrequency=function(t){var n=this.getFrequency(t)+1,i=new Date;i.setDate(i.getDate()+1),i.setHours(0),i.setMinutes(0),i.setSeconds(0);for(var r=this.getCampaigns(),o=r.length,s=0;s<o;s++)if(r[s].match("^"+t+"=")){r.splice(s,1);break}r.push(t+"="+n),document.cookie="nicoads_fc="+r.join("|")+"; "+e.domainPath+"; expires="+i.toUTCString()},e.domainPath="domain=.nicovideo.jp; path=/;",e}();t.Frequency=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SidewallSwitchView=void 0;var i=n(23),r=function(){function e(e){var t=this;if(this.switchViewLeft=null,this.switchViewRight=null,this.interval=0,this.second=0,this.responseLength=0,this.index=0,this.switchAdIntervalID=0,this.ignoreScreen=!1,this.ignoreFocus=!1,this.wasActive=!0,this.useWeightRotation=!1,this.switchAdTimerHandler=function(){if(t.switchViewLeft.isZombie()||t.switchViewRight.isZombie())return t.stopSwitchAdTimer(),t.switchViewLeft.destroy(),void t.switchViewRight.destroy();t.isActive()&&t.second++>=t.interval&&t.switchNext()},e&&"number"!=typeof e)throw new Error("interval is not number.");if(e<0)throw new Error("The interval must be greater than or equal to 0.");this.interval=e||30}return e.prototype.setIgnoreScreen=function(){return this.ignoreScreen=!0,this},e.prototype.setIgnoreFocus=function(){return this.ignoreFocus=!0,this},e.prototype.display=function(e,t){e.left&&e.right&&t.left&&t.right&&t.left.length===t.right.length&&(this.responseLength=t.left.length,this.useWeightRotation=t.left.some(function(e){return null===e.rotation_priority}),this.switchViewLeft=new i.SidewallSwitchViewChild(e.left,t.left),this.switchViewRight=new i.SidewallSwitchViewChild(e.right,t.right),this.show(),this.startSwitchAdTimer())},e.prototype.startSwitchAdTimer=function(){this.switchAdIntervalID=window.setInterval(this.switchAdTimerHandler,1e3)},e.prototype.stopSwitchAdTimer=function(){clearInterval(this.switchAdIntervalID)},e.prototype.isActive=function(){return(this.switchViewLeft.isScreen()&&this.switchViewRight.isScreen()||this.ignoreScreen)&&(document.hasFocus()||this.ignoreFocus)},e.prototype.switchNext=function(){var e=this;this.second=0,window.setTimeout(function(){return e.show()},500)},e.prototype.show=function(){this.switchViewLeft.showAd(this.index),this.switchViewRight.showAd(this.index),this.useWeightRotation?this.updateIndexForWeightRotation():this.updateIndexForSequentialRotation()},e.prototype.updateIndexForSequentialRotation=function(){this.index++,this.index%=this.responseLength},e.prototype.updateIndexForWeightRotation=function(){var e=this,t=this.switchViewLeft.responses.map(function(e){return e.weight}),n=t.reduce(function(e,t){return e+t},0),i=Math.random()*n,r=0;t.forEach(function(t,n){i<(r+=t)&&(e.index=n)})},e}();t.SidewallSwitchView=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SidewallSwitchViewChild=void 0;var i=n(0),r=n(1),o=n(3),s=n(2),a=function(){function e(e,t){this.advertisement=null,this.responses=null,this.canvas=null,this.template=null,t.length<1||(this.advertisement=e,this.responses=t,this.canvas=document.createElement("div"),this.canvas.id=this.advertisement.getElement().id+"_child",this.advertisement.getElement().appendChild(this.canvas))}return e.prototype.initCanvas=function(e){e.getWidth()&&e.getHeight()&&(this.canvas.style.width=e.getWidth()+"px",this.canvas.style.height=e.getHeight()+"px"),this.canvas.innerHTML=""},e.prototype.showAd=function(e){if(this.responses&&!(e>this.responses.length-1)){var t=this.responses[e];this.template=new o.Template(this.advertisement,t),this.initCanvas(this.template),i.updateElement(this.canvas,this.template.getString())&&(1===this.advertisement.impression&&(r.Api.logImpression(t.campaignid,t.bannerid,t.zoneid).catch(function(){}),r.Api.callThirdPartyTracking(t)),s.Utility.observationViewableImpression(this.advertisement,t.campaignid,t.bannerid,t.zoneid),t.optional&&(document.body.style.backgroundColor=t.optional))}},e.prototype.isScreen=function(){var e=this.advertisement.getElement();if("fixed"===(e.currentStyle||window.getComputedStyle(e,null)).position)return!0;var t=s.Utility.getScroll(),n=i.isBackCompat?{width:document.body.clientWidth||window.innerWidth,height:document.body.clientHeight||window.innerHeight}:{width:document.documentElement.clientWidth||window.innerWidth,height:document.documentElement.clientHeight||window.innerHeight},r=this.canvas;if(!this.advertisement.activatesAdjust&&n.width<=this.advertisement.contentsWidth)return!1;var o=r.currentStyle||window.document.defaultView.getComputedStyle(r,null);if(o.position&&"fixed"===o.position)return!0;var a=this.advertisement.getElement(),l=a.currentStyle||window.document.defaultView.getComputedStyle(a,null);if(l.position&&"fixed"===l.position)return!0;var d=function(){var e=r,t={top:0,left:0,right:0,bottom:0};do{t.top+=e.offsetTop||0,t.left+=e.offsetLeft||0}while(e=e.offsetParent);return t.right=t.left+r.offsetWidth,t.bottom=t.top+r.offsetHeight,t}();return this.advertisement.getElement().clientWidth>0&&d.right>t.left&&d.bottom>t.top&&d.left<n.width+t.left&&d.top<n.height+t.top},e.prototype.isZombie=function(){var e=this.canvas;do{if("BODY"===e.nodeName)return!1}while(e=e.parentNode);return!0},e.prototype.destroy=function(){this.canvas.innerHTML="",this.canvas=null},e}();t.SidewallSwitchViewChild=a},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SwitchView=void 0;var o=n(4),s=n(1),a=n(11),l=n(3),d=n(2),h=function(e){function t(t,n){var i=e.call(this)||this;if(i.EVENT_AD_VISIBLE="EVENT_VISIBLE_AD",i.EVENT_AD_INVISIBLE="EVENT_INVISIBLE_AD",i.advertisement=null,i.responses=null,i.index=0,i.second=0,i.interval=0,i.canvas=null,i.prevVisibility=!0,i.ignoreScreen=!1,i.ignoreFocus=!1,i.switchAdIntervalID=0,i.activeVisibilityEvent=!1,i.eVisible=!0,i.useWeightRotation=!1,i._isScreen=!1,i.template=null,t&&"number"!=typeof t)throw new Error("interval is not number.");i.interval=t||30,i.backgroundColor="string"==typeof n?n:"#efefef",i.addListener(i.EVENT_AD_VISIBLE,function(){this.eVisible=!0},i),i.addListener(i.EVENT_AD_INVISIBLE,function(){this.eVisible=!1},i);return i._io=new o.IntersectionObserver(function(e){i._isScreen=e.every(function(e){return e.isIntersecting})},{threshold:.01}),i}return r(t,e),t.prototype.setIgnoreScreen=function(){return this.ignoreScreen=!0,this},t.prototype.setIgnoreFocus=function(){return this.ignoreFocus=!0,this},t.prototype.setActiveVisibilityEvent=function(){return this.activeVisibilityEvent=!0,this},t.prototype.display=function(e,t){var n=this;this.setting(e,t),this.useWeightRotation=t.some(function(e){return null===e.rotation_priority}),this.switchAdIntervalID=window.setInterval(function(){n.isZombie()?n.destroy():n.isActive()&&n.switchNext()},1e3)},t.prototype.stopSwitchAdTimer=function(){clearInterval(this.switchAdIntervalID)},t.prototype.setting=function(e,t){if(this.advertisement=e,this.responses=t,null!=this.advertisement.getElement()){this.canvas=document.createElement("div"),this.advertisement.getElement().appendChild(this.canvas);var n=this.getNextResponse();if(this.template=new l.Template(this.advertisement,n),this.initCanvas(n),this.show(n),this._io.observe(this.canvas),this.advertisement.closeableActionElementId)document.getElementById(this.advertisement.closeableActionElementId).innerHTML=this.template.getCloseableButtonHtml()}},t.prototype.getNextResponse=function(){return this.useWeightRotation?this.getWeightRotationResponse():this.getSequentialRotationResponse()},t.prototype.getSequentialRotationResponse=function(){var e=this.index;return this.index++,this.index%=this.responses.length,this.responses[e]},t.prototype.getWeightRotationResponse=function(){for(var e=this.responses.map(function(e){return e.weight}),t=e.reduce(function(e,t){return e+t},0),n=Math.random()*t,i=0,r=0;r<e.length;r++)if(n<(i+=e[r])){this.index=r;break}return this.responses[this.index]},t.prototype.switchNext=function(){var e=this,t=this.getNextResponse();this.initCanvas(t),window.setTimeout(function(){e.show(t),e.second=0},500)},t.prototype.initCanvas=function(e){null===this.template?this.template=new l.Template(this.advertisement,e):this.template.setResponse(e),this.template.getWidth()&&this.template.getHeight()&&(this.canvas.style.width=this.template.getWidth()+"px",this.canvas.style.height=this.template.getHeight()+"px"),this.template.isText()||(this.canvas.style.backgroundColor=this.backgroundColor),this.canvas.innerHTML=""},t.prototype.show=function(e){null===this.template?this.template=new l.Template(this.advertisement,e):this.template.setResponse(e),this.canvas.innerHTML=this.template.getString(),1===this.advertisement.impression&&(s.Api.logImpression(e.campaignid,e.bannerid,e.zoneid).catch(function(){}),s.Api.callThirdPartyTracking(e)),d.Utility.observationViewableImpression(this.advertisement,e.campaignid,e.bannerid,e.zoneid)},t.prototype.isActive=function(){var e=this.activeVisibilityEvent?this.eVisible:this.isScreen()&&(document.hasFocus()||this.ignoreFocus);return this.prevVisibility!==e?(this.prevVisibility=e,this.prevVisibility):this.prevVisibility&&this.isIntervalPass()},t.prototype.isIntervalPass=function(){return!(this.second<this.interval)||(this.second++,!1)},t.prototype.isScreen=function(){if(this.ignoreScreen)return!0;var e=this.canvas;if(!e)return!1;for(var t=e;t.parentElement;t=t.parentElement)if("none"===t.style.display)return!1;return this._isScreen},t.prototype.isZombie=function(){var e=this.canvas;do{if("BODY"===e.nodeName)return!1}while(e=e.parentNode);return!0},t.prototype.destroy=function(){this.stopSwitchAdTimer(),this._io.unobserve(this.canvas),this.canvas.innerHTML="",this.canvas=null},t}(a.EventManager);t.SwitchView=h}]);
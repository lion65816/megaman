//serverPlayerPath = https://cdn.bluebillywig.com/apps/player/20221031.124020/ 


	// Player Five
	(function(){
	// metadata
	var opts = {"protocol":"https:\/\/","userLanguage":null,"userDeviceType":"DESKTOP","contentIndicator":"a","contentId":"seesaa_outstream_atf_pc_jp_not_updated_page_2","embedData":{"contentId":"seesaa_outstream_atf_pc_jp_not_updated_page_2","forceSSL":true,"contentIndicator":"a","playoutSafeName":"__on_the_fly__seesaa_outstream_atf_pc_jp_not_updated_page_2","playoutIndicator":"p","baseurl":"https:\/\/pubmatic.bbvms.com"},"adServicesData":[{"id":"7250","status":"published","timeout":10,"playout":{"label":"inarticle","autoHeight":"false","responsiveSizing":"true","width":"100%","height":"1","commercials":"true","preferFlashPlayback":"false","disableHtml5VPAID":"false","enableHtml5VPAID":"true","commercialPauseButton":"true","commercialMuteButton":"true","commercialProgressBar":"true","commercialProgressBarColor":"FFCC00","commercialBehaviour":"Once per load","minClipDurationPreroll":"","minClipDurationPostroll":"","textAbovePlayer":"","textCommercialSkip":"","skipCounterText":"You can skip this ad in ","skipButtonText":"Skip ad","upcomingText":"Video will play after this ad","preloadMainroll":"false","textCommercialTimeRemaining":"","autoPlay":"false","autoMute":"true","autoLoop":"false","upcomingVideo":"false","interactivity_inView":"play","interactivity_outView":"pause","interactivity_mouseIn":"none","interactivity_mouseOut":"none","inviewMargin":"50%","stickyMode":"","hideFloatingClose":"false","disableFloatAnimation":"false","interactivity_onClick":"none","clickUrl":"","startCollapsed":"true","playInOverlay":"false","hidePlayerOnEnd":"true","waitForApproval":"false","placementOption":"default","placementDOMSelector":"","iframeBreakout":"true","clearBothOption":"never","nsiNoAutoPlay":"false","nsiNoPlayer":"false","alphaControlBar":"100","skin_backgroundColor":"ffffff","skin_foregroundColor":"6699CC","skin_widgetColor":"ffffff","bgColor":"808080","placeholderTextColor":"ffffff","placeholderText":"Learn more","ctaTextColor":"ffffff","ctaText":"Learn more","logoId":"","logoAlign":"TOPRIGHT","logoClickUrl":"","controlBar":"Autohide","controlBarPlacement":"Auto","timeDisplay":"Hide","timeLine":"Show","muteButton":"Show","volume":"Show","volumeOrientation":"vertical","languageSelect":"Show","qualitySelector":"Show","fullScreen":"Show","shareButton":"Hide","showBigPlayButton":"true","showBigReplayButton":"true","title":"Hide","authorCopyright":"Hide","relatedItems":"Hide","sharePlayout":"","skinBehaviour":"Auto","skinOnTimeline":"false","nativeControls":"true","forceNativeFullscreen":"false","preferHD":"false","youTubeHosting":"false","youTubeSkinInMainPhase":"false","nedStatLoggerUrl":"","googleAnalyticsId":"","disableCookies":"false","disableContextMenuNavigate":"false","playerSignature":"","playerSignatureLink":"","fitmode":"","allowImageSequence":"true","forceInview":"false","customCode":"","skipOffset":"-1","allowBBIma":"true","aspectRatio":""},"lineitems":[{"id":"12613","status":"published","creativeType":"VAST","timeout":10,"playout":{"commercialBehaviour":"","disableControls":"false","imaCustomPlaybackForIOS10Plus":"","skipButtonText":"Skip ad","skipCounterText":"You can skip this ad in "},"code":"seesaa_outstream_atf_pc_jp_not_updated_page_2","vast_url":"https:\/\/vpaid.pubmatic.com\/ads\/video\/vadtag.html?adtype=13&pubId=47150&siteId=895688&adId=4106459&vadFmt=3&vapi=2&vminl=1&vmaxl=60&vh=90&vw=728&placement=2&vtype=0&vpos=1&vplay=2+6&vskip=0&vcom=0&vfmt=1+3+4+5+6+7+9+10+11+12&sec=1&kadpageurl=https%3A%2F%2Fblog.seesaa.jp%2F"}],"positionType":"inarticle","code":"seesaa_outstream_atf_pc_jp_not_updated_page_2"}],"clipData":{"id":"0","usetype":"commercial","mediatype":"mainroll"},"playerWidth":"100%","playerHeight":"1","playerUrl":"https:\/\/pubmatic.bbvms.com\/p\/inarticle\/player7ab46b7ac5a4963bb446284fd54ef080.swf","playoutData":{"id":"0","main":"false","publicationid":"548","type":"Playout","name":"[untitled]","status":"active","createddate":"2022-11-01T22:25:46Z","updateddate":"2022-11-01T22:25:46Z","label":"label0","publication":"pubmatic","player":{"id":"48","name":"Blue Billywig Standard refs\/heads\/release\/v7.94","type":"swf","src":"","html5src":"https:\/\/cdn.bluebillywig.com\/apps\/player\/20221031.124020\/","updateddate":"2022-10-31T12:41:16Z"},"playerid":"48","responsiveSizing":"true","width":"100%","height":"1","autoHeight":"false","alphaControlBar":"100","skin_backgroundColor":"ffffff","skin_foregroundColor":"6699CC","skin_widgetColor":"ffffff","bgColor":"808080","logoId":"","logoAlign":"TOPRIGHT","logoClickUrl":"","controlBar":"Autohide","timeDisplay":"Hide","timeLine":"Show","muteButton":"Show","volume":"Show","volumeOrientation":"vertical","languageSelect":"Show","qualitySelector":"Show","audioTrackSelect":"show","fullScreen":"Show","shareButton":"Hide","showBigPlayButton":"true","title":"Hide","authorCopyright":"Hide","authorCopyrightAlign":"TOPRIGHT","authorCopyrightPrefixText":"source:","relatedItems":"Hide","useDeeplinkForRelatedItems":"false","exitscreenItemsListId":"","randomizeRelatedItems":"false","useDeeplinkForFacebook":"false","shareText":"Currently watching:","sharePlayout":"","shareButtonEmbedCode":"true","shareButtonEmail":"false","shareButtonFacebook":"true","shareButtonGooglePlus":"true","shareButtonLinkedIn":"true","shareButtonPinterest":"false","shareButtonTwitter":"true","shareButtonWhatsApp":"true","skinBehaviour":"Auto","nativeControls":"true","youTubeHosting":"false","forceNativeFullscreen":"false","preferHD":"false","noStats":"false","nedStatLoggerUrl":"","googleAnalyticsId":"","googleAnalytics_customVars":"","piwikUrl":"","piwikSiteId":"","adobeAnalytics_trackingServer":"","adobeAnalytics_mcorgId":"","adobeAnalytics_rsId":"","adobeAnalytics_legacy":"false","disableCookies":"false","disableContextMenuNavigate":"false","playerSignature":"","playerSignatureLink":"","defaultSubtitle":"first","defaultAudioTrack":"first","autoPlay":"false","forceCanAutoPlay":"false","autoMute":"true","autoLoop":"false","stickyMode":"","interactivity_inView":"play","interactivity_outView":"pause","inviewMargin":"50%","textAbovePlayer":"","textCommercialSkip":"","startCollapsed":"true","playInOverlay":"false","hidePlayerOnEnd":"true","waitForApproval":"false","disableKeyboardControls":"false","taggingDisabled":"false","interactivity_mouseIn":"none","interactivity_mouseOut":"none","interactivity_onClick":"none","clickUrl":"","nsiNoAutoPlay":"false","nsiNoPlayer":"false","placementOption":"default","placementDOMSelector":"","iframeBreakout":"true","clearBothOption":"never","forceInview":"false","customCode":"","preloadMainroll":"false","enableHtml5VPAID":"true","commercialPauseButton":"true","commercialMuteButton":"true","commercials":"true","textCommercialTimeRemaining":"","commercialBehaviour":"Once per load","skipOffset":"-1","skipCounterText":"You can skip this ad in ","skipButtonText":"Skip ad","minClipDurationPreroll":"","minClipDurationPostroll":"","allowBBIma":"true","blockInsecureVPAID":"false","viewpage_overrideDimensions":"false","viewpage_hideTitles":"false","viewpage_alignment":"center","viewpage_color":"fffff","viewpage_backgroundClipId":"","viewpage_backgroundPosition":"top left","viewpage_backgroundSize":"cover","viewpage_backgroundRepeat":"no-repeat","viewpage_backgroundColor":"fffff","viewpage_logo1ClipId":"","viewpage_logo1Position":"top left","viewpage_logo2ClipId":"","viewpage_logo2Position":"top right","viewpage_logo3ClipId":"","viewpage_logo3Position":"bottom left","viewpage_logo4ClipId":"","viewpage_logo4Position":"bottom right","preferFlashPlayback":"false","disableHtml5VPAID":"false","commercialProgressBar":"true","commercialProgressBarColor":"FFCC00","upcomingText":"Video will play after this ad","upcomingVideo":"false","hideFloatingClose":"false","disableFloatAnimation":"false","placeholderTextColor":"ffffff","placeholderText":"Learn more","ctaTextColor":"ffffff","ctaText":"Learn more","controlBarPlacement":"Auto","showBigReplayButton":"true","skinOnTimeline":"false","youTubeSkinInMainPhase":"false","fitmode":"","allowImageSequence":"true","aspectRatio":"","adunits":null,"hasAdunits":false},"publicationData":{"baseurl":"https:\/\/pubmatic.bbvms.com","defaultMediaAssetPath":"https:\/\/d1fvoecc8xozrx.cloudfront.net","customfields":[],"name":"pubmatic"},"scriptTarget":"https:\/\/cdn.bluebillywig.com\/apps\/player\/20221031.124020\/","playerBase":"https:\/\/cdn.bluebillywig.com\/apps\/player\/20221031.124020\/","playerPath":"https:\/\/cdn.bluebillywig.com\/apps\/player\/20221031.124020\/","scriptLink":"https:\/\/pubmatic.bbvms.com\/a\/seesaa_outstream_atf_pc_jp_not_updated_page_2.js","callback":null};

	// include bluebillywig script
	// NB leave empty line below!

	var me = document.currentScript;
if (typeof opts === 'undefined') var opts = null;

if (me) {
	opts.embedScriptElement = me;
}

var genericData = opts && opts.clipData;
if (opts && opts.projectData) {
	genericData = opts.projectData;
	genericData.mediatype = 'video';
}

var _findScript = function (srcString, opts) {
	var scriptFound = document.currentScript;
	opts = opts || {};

	if (!scriptFound) {
		if (opts.lastScript && opts.lastScript.src && opts.lastScript.src.indexOf(srcString) !== -1) {
			scriptFound = opts.lastScript;
		} else {
			var scriptList = document.querySelectorAll('body script');
			for (var i = 0, l = scriptList.length; i < l; i++) {
				var item = scriptList.item(i);
				if (item.src && item.src.indexOf(srcString) !== -1) {
					scriptFound = item;
				}
			}
		}
	}

	if (!scriptFound) {
		var altString = '/' + opts.embedData.contentIndicator + '/' + opts.embedData.contentId;
		if (opts.lastScript && opts.lastScript.src && opts.lastScript.src.indexOf(altString) !== -1) {
			scriptFound = opts.lastScript;
		} else {
			var scriptList = document.querySelectorAll('body script');
			for (var i = 0, l = scriptList.length; i < l; i++) {
				var item = scriptList.item(i);
				if (item.src && item.src.indexOf(altString) !== -1) {
					scriptFound = item;
				}
			}
		}
	}

	if (!scriptFound) {
		var scriptList = document.querySelectorAll('body script');
		for (var i = 0, l = scriptList.length; i < l; i++) {
			var item = scriptList.item(i);
			if (item.innerHTML.indexOf(srcString) !== -1) {
				scriptFound = item;
			}
		}
	}

	return scriptFound;
};

var scriptUrl = null;
if (opts.embedData) {
	var srcString = opts.embedData.baseurl + '/p/' + opts.embedData.playoutSafeName + '/' + opts.embedData.contentIndicator + '/' + opts.embedData.contentId;

	var scriptFound = _findScript(srcString, opts);
	if (scriptFound && scriptFound.src) scriptUrl = scriptFound.src;
}

opts.requestParams = opts.requestParams || {};
var requestParamsUrl = (scriptUrl && scriptUrl.indexOf('useHostPageQueryString') > -1) ? document.location.href : scriptUrl;
if (requestParamsUrl) {
	if (typeof URL === 'function' && typeof URLSearchParams === 'function') {
		try {
			var url = new URL(requestParamsUrl, 'https://bbvms.com/'); // supplying base avoids exceptions
			var params = url.searchParams;
			params.forEach(function (value, key) {
				opts.requestParams[key] = value;
			});
		} catch (er) {}
	} else {
		var queryString = ''
		var re = /\?([^#]*)/;
		var result = re.exec(requestParamsUrl);
		if (result && result.length > 1) {
			queryString = result[1];
		}
		var parts = queryString.split('&');
		for (var i = 0, l = parts.length; i < l; i++) {
			var key = '';
			var value = null;
			try {
				var index = parts[i].indexOf('=');
				if (index >= 0) {
					key = decodeURIComponent(parts[i].substring(0, index));
					value = decodeURIComponent(parts[i].substring(index + 1));
				} else {
					key = decodeURIComponent(parts[i]);
				}
			} catch (er) {}
			opts.requestParams[key] = value;
		}
	}
}

var requestParams_inView = (opts && opts.requestParams && opts.requestParams.interactivity_inView) || '';
var playoutData_inView = (opts && opts.playoutData && opts.playoutData.interactivity_inView) || '';
if (me && opts && genericData && 
		(genericData.mediatype === "video" || genericData.mediatype === "audio" || genericData.mediatype === "image") &&
		genericData['id'] > 0 &&
		opts.playoutData && 
		(opts.requestParams.showOnlyWhenPrerollAvailable !== 'true' && opts.playoutData.showOnlyWhenPrerollAvailable !== 'true') &&
		(opts.requestParams.avoidPreloadImage !== 'true' && opts.playoutData.avoidPreloadImage !== 'true') &&
		(opts.requestParams.autoPlay !== 'true' && opts.playoutData.autoPlay !== 'true') &&
		(!requestParams_inView.match(/play/i) && !playoutData_inView.match(/play/i)) &&
		( ! opts.playoutData.placementOption ||  opts.playoutData.placementOption === "default") &&
		( ! opts.requestParams.placementOption ||  opts.requestParams.placementOption === "default")
	){
	var thumbDiv = document.createElement('div');

	// keep in sync with (Outstream)Player.js
	var safeContentId = opts.embedData.contentId ? opts.embedData.contentId.replace(/[^\w-]/g, '_') : "";
	var safePlayoutLabel = opts.playoutData && opts.playoutData.label ? opts.playoutData.label.replace(/[^\w-]/g, '_') : "";
	var divId = "bb-ac-" + safePlayoutLabel + '-' + safeContentId;
	thumbDiv.id = divId;
	thumbDiv.style.position = 'relative';

	if (document.getElementById(divId) === null && document.querySelector('body script[src="'+me.getAttribute('src')+'"]')) {
		var styleNode = document.createElement('style');
		styleNode.type = "text/css";
		styleNode.appendChild( document.createTextNode('@keyframes bbspin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }') );

		var loadDiv = document.createElement('div');
		loadDiv.style.position = 'absolute';
		loadDiv.style.top = '50%';
		loadDiv.style.left = '50%';
		loadDiv.style.borderRadius = '50%';
		loadDiv.style.marginTop = '-12px';
		loadDiv.style.marginLeft = '-12px';
		loadDiv.style.width = '24px';
		loadDiv.style.height = '24px';
		loadDiv.style.border = '.25rem solid rgba(255,255,255,0.35)';
		loadDiv.style.borderTopColor = '#ffffff';
		loadDiv.style.animation = 'bbspin 1250ms infinite linear';

		var width = 768;
		var height = 432;
		var aspectRatio = width / height;
		let aspectRatioStr = `${width} / ${height}`;
		var thumb = document.createElement('img');
		var thumbWidth = width;
		var thumbHeight = height;
		if ((opts.playoutData && (opts.playoutData.responsiveSizing === "true" || opts.playoutData.autoHeight === "true")) ||
			(opts.requestParams && (opts.requestParams.responsiveSizing === "true" || opts.requestParams.autoHeight === "true"))) {
			width = ''+(me.parentNode && me.parentNode.offsetWidth);
			thumbDiv.style.width = "100%";
			// aspect ratio
			var parts = null;
			if (opts.requestParams && opts.requestParams.aspectRatio && opts.requestParams.aspectRatio.indexOf(':') !== -1) {
				parts = opts.requestParams.aspectRatio.split(':');
				if (parts[0] && !isNaN(parseFloat(parts[0])) && 
					parts[1] && !isNaN(parseFloat(parts[1]))
				) {
					aspectRatio = Math.abs(parseFloat(parts[0]) / parseFloat(parts[1]));
					aspectRatioStr = `${parseFloat(parts[0])} / ${parseFloat(parts[1])}`;
				}
			} else if (opts.playoutData && opts.playoutData.aspectRatio && opts.playoutData.aspectRatio.indexOf(':') !== -1) {
				parts = opts.playoutData.aspectRatio.split(':');
				if (parts[0] && !isNaN(parseFloat(parts[0])) && 
					parts[1] && !isNaN(parseFloat(parts[1]))
				) {
					aspectRatio = Math.abs(parseFloat(parts[0]) / parseFloat(parts[1]));
					aspectRatioStr = `${parseFloat(parts[0])} / ${parseFloat(parts[1])}`;
				}
			}
		} else { // not responsive
			width = opts.requestParams.width || opts.playoutData.width;
			thumbDiv.style.width = (width && !width.match(/%$/) && !isNaN(parseFloat(width))) ? ''+Math.abs(parseFloat(width))+'px' : width;
			// aspect ratio
			height = opts.requestParams.height || opts.playoutData.height;
			if (width && !width.match(/%$/) && !isNaN(parseFloat(width)) && 
				height && !height.match(/%$/) && !isNaN(parseFloat(height))
			) {
				aspectRatio = Math.abs(parseFloat(width) / parseFloat(height));
				aspectRatioStr = `${width} / ${height}`;
			}
		}
		if (width && !width.match(/%$/) && !isNaN(parseFloat(width)) && width > 0) {
			thumbWidth = parseFloat(width);
			var mod16rest = thumbWidth % 16;
			thumbWidth -= mod16rest;
			thumbHeight = Math.round(thumbWidth / aspectRatio);
		}
		thumbDiv.style.aspectRatio = aspectRatioStr;
		var scalingMode = 'cover';
		var fitmode = 'FIT_SMART';
		if (opts.playoutData && opts.playoutData['fitmode']) fitmode = opts.playoutData['fitmode'];
		if (genericData && genericData['fitmode']) fitmode = genericData['fitmode'];
		if (fitmode === 'FIT_STRETCH') {
			scalingMode = 'stretch';
		}
		var entityType = genericData['type'] && genericData.type.toLowerCase(); // mediaclip or project
		
		var hasThumbnails = false;
		if ( entityType === 'mediaclip' ) {
			if ( genericData.thumbnails && genericData.thumbnails.length && genericData.thumbnails.length > 0 ) {
				hasThumbnails = true;
			}
		} else if ( entityType === 'project' ) {
			// check on project for future entitytypes, project thumbnail can be retreived from project clips in BE so always set to true
			hasThumbnails = true;
		}
		
		//dont use src urls that will result in a 404
		thumb.src = hasThumbnails ? opts.embedData.baseurl + '/' + entityType +'/' + genericData['id'] + '/pthumbnail/'+thumbWidth+'/'+thumbHeight+'.jpg?scalingMode='+scalingMode : '';
		thumb.style.width = '100%';
		thumb.setAttribute('alt', 'poster');

		thumbDiv.appendChild(styleNode);
		thumbDiv.appendChild(loadDiv);
		thumbDiv.appendChild(thumb);

		me.parentNode.insertBefore(thumbDiv, me.nextSibling);
	}
}

// gets included, needs opts variable.
window.bluebillywig = window.bluebillywig || {};
window.bluebillywig._internal = window.bluebillywig._internal || {};
if (typeof window.bluebillywig._internal.loadPlayer != "function") {
	window.bluebillywig._internal.loadPlayer = function(opts){
		var isOutstream = opts && opts.embedData && opts.embedData.contentIndicator === 'a';
		var playerApiName = isOutstream ? 'OutstreamPlayer' : 'Player';

		if (window.location.hash.indexOf("_bbdebug") != -1) {
			var hashParts = window.location.hash.split("&");
			var hashVars = {};
			for (var i = 0; i < hashParts.length; i++) { //>
				var pair = hashParts[i].split("=");
				hashVars[ pair[0] ] = decodeURIComponent(pair[1]);
			}

			switch(hashVars.pm) {
				default:
				case "trunk":
					var target = "targets/";
					opts.cachedPlayer = false;
					if (hashVars.target) { target += hashVars.target + "/"; } else { target = ""; }
					if (hashVars.devmode) {
						target += hashVars.devmode + "/";
					} else {
						target += "build/";
					}
					
					opts["scriptTarget"] = opts["playerBase"] = opts["protocol"] + "bb.dev.bbvms.com/player/standard/" + target;
				  break;
				case "dev":
					opts["scriptTarget"] = opts["playerBase"] = opts["protocol"] + "bb.dev.bbvms.com/publications/__root_dev__/player/html5/player/";
				  break;
				case "acc":
					opts["scriptTarget"] = opts["playerBase"] = opts["protocol"] + "bb.acc.bbvms.com/publications/__root__/player/html5/player/";
				  break;
				case "prod":
				case "preview":
					opts["scriptTarget"] = opts["playerBase"] = opts["protocol"] + "bb.bbvms.com/publications/__root__/player/html5/player/";
					
				  break;
			}
			opts["playerPath"] = opts["scriptTarget"];
		}

		var cb = opts.cachedPlayer ? (opts.bbcb ? '?bbcb=' + opts.bbcb : '') : '?'+(new Date().getTime()); // cachebuster
		
		function logEvent(properties) {
			var qs = "";
			for (var prop in properties) {
				if (qs.length == 0) qs += "?"; else qs += "&";
		
				var value = properties[prop];
				if (value == null) value = "";
				qs += prop + "=" + encodeURIComponent(value);
			}		
			qs = qs.replace(/-/g, "%2d" );
	
			var dummy = new Image( 1,1 );	
			dummy.src = 'https://stats.bluebillywig.com' + qs;
		};

		var playerScript = isOutstream ? 'outstreamPlayerScript' : 'playerScript';
		var playerLoadingProp = isOutstream ? 'outstreamPlayerLoading' : 'playerLoading';

		function waitForScript(){
			bluebillywig._internal[playerScript].addEventListener("load", function() {
				bluebillywig._internal[playerLoadingProp] = false;
				try {
					var pl = new bluebillywig[playerApiName](opts);
					bluebillywig.players.push( pl );
				} catch(er) {
					var properties = {'ev':'pf'};
					if (opts && opts['playoutData']) properties['pp'] = opts['playoutData']['publication'];
					if (opts && opts['embedData']) properties['cid'] = opts['embedData']['contentId'];
					properties['why'] = 'error instantiating bluebillywig.' + playerApiName + ' from '+bluebillywig._internal[playerScript].getAttribute('src')+': '+er.stack.replace(/\(.*\)/gm, '');
					logEvent(properties);

					// retry once
					if (opts && opts['publicationData'] && opts['publicationData']['loadPlayerRetryOnce'] === 'true' && !bluebillywig._internal.retried) {
						bluebillywig._internal.retried = true;
						bluebillywig[playerApiName] = null;
						var now = new Date();
						opts['bbcb'] += '__retry__'+now.getTime();
						window.bluebillywig._internal.loadPlayer(opts);
					}
				}
			}, true);
		}
		
		opts.lastScript=document.getElementsByTagName("script")[ document.getElementsByTagName("script").length-1 ];
		bluebillywig.players = bluebillywig.players || [];
		if (bluebillywig[playerApiName]) {
			bluebillywig.players.push( new bluebillywig[playerApiName](opts) ); // embed new player with options
		} else if (bluebillywig._internal[playerLoadingProp] === true){
			waitForScript();
		} else {
			bluebillywig._internal[playerLoadingProp] = true;
			bluebillywig._internal[playerScript] = document.createElement("script");
			bluebillywig._internal[playerScript].setAttribute("type", "text/javascript");
			var playerFile = isOutstream ? "os-player.js" : "player.js";
			bluebillywig._internal[playerScript].setAttribute("src", opts.playerPath + playerFile + cb);
			waitForScript();
			document.getElementsByTagName("head")[0].appendChild(bluebillywig._internal[playerScript]);
		}		
	};
};
if (typeof window.bluebillywig.getPlayerInstance != "function") {
	window.bluebillywig.getPlayerInstance = function(playerIdOrObject){
		var ret = false;
		var j = 0;
		if (window.bluebillywig && window.bluebillywig.players && window.bluebillywig.players.length){
			if (window.bluebillywig.players.length == 1){
				return window.bluebillywig.players[0];
			}
			
			for(var i = 0;i < window.bluebillywig.players.length;i++) {
				if (typeof playerIdOrObject == "object"){
					if (window.bluebillywig.players[i]._internal && window.bluebillywig.players[i]._internal.$wrapper){
						var obj = window.bluebillywig.players[i]._internal.$wrapper[0];
						if (obj == playerIdOrObject) {
							ret = window.bluebillywig.players[i];
							j++;
						}
					}
				} else {
					if (window.bluebillywig.players[i]._id.indexOf( String(playerIdOrObject) ) != -1){
						ret = window.bluebillywig.players[i];
						j++;
					}	
				}
			}
		}
		if (j != 1){ret = false;}
		
		return ret;
	};
}
window.bluebillywig._internal.loadPlayer(opts);
;

	// NB leave empty line above!
	// include tagging engine script
	// NB leave empty line below!

	(function(opts) { // begin closure
/*
 * Copyright Blue Billywig 2016
 * 
 * Author(s): J. Koppen <j.koppen@bluebillywig.com>
 */


var SHA1 = function(e){function t(e,t){var n=e<<t|e>>>32-t;return n}function n(e){var t="";var n;var r;var i;for(n=0;n<=6;n+=2){r=e>>>n*4+4&15;i=e>>>n*4&15;t+=r.toString(16)+i.toString(16)}return t}function r(e){var t="";var n;var r;for(n=7;n>=0;n--){r=e>>>n*4&15;t+=r.toString(16)}return t}function i(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r)}else if(r>127&&r<2048){t+=String.fromCharCode(r>>6|192);t+=String.fromCharCode(r&63|128)}else{t+=String.fromCharCode(r>>12|224);t+=String.fromCharCode(r>>6&63|128);t+=String.fromCharCode(r&63|128)}}return t}var s;var o,u;var a=new Array(80);var f=1732584193;var l=4023233417;var c=2562383102;var h=271733878;var p=3285377520;var d,v,m,g,y;var b;e=i(e);var w=e.length;var E=new Array;for(o=0;o<w-3;o+=4){u=e.charCodeAt(o)<<24|e.charCodeAt(o+1)<<16|e.charCodeAt(o+2)<<8|e.charCodeAt(o+3);E.push(u)}switch(w%4){case 0:o=2147483648;break;case 1:o=e.charCodeAt(w-1)<<24|8388608;break;case 2:o=e.charCodeAt(w-2)<<24|e.charCodeAt(w-1)<<16|32768;break;case 3:o=e.charCodeAt(w-3)<<24|e.charCodeAt(w-2)<<16|e.charCodeAt(w-1)<<8|128;break}E.push(o);while(E.length%16!=14)E.push(0);E.push(w>>>29);E.push(w<<3&4294967295);for(s=0;s<E.length;s+=16){for(o=0;o<16;o++)a[o]=E[s+o];for(o=16;o<=79;o++)a[o]=t(a[o-3]^a[o-8]^a[o-14]^a[o-16],1);d=f;v=l;m=c;g=h;y=p;for(o=0;o<=19;o++){b=t(d,5)+(v&m|~v&g)+y+a[o]+1518500249&4294967295;y=g;g=m;m=t(v,30);v=d;d=b}for(o=20;o<=39;o++){b=t(d,5)+(v^m^g)+y+a[o]+1859775393&4294967295;y=g;g=m;m=t(v,30);v=d;d=b}for(o=40;o<=59;o++){b=t(d,5)+(v&m|v&g|m&g)+y+a[o]+2400959708&4294967295;y=g;g=m;m=t(v,30);v=d;d=b}for(o=60;o<=79;o++){b=t(d,5)+(v^m^g)+y+a[o]+3395469782&4294967295;y=g;g=m;m=t(v,30);v=d;d=b}f=f+d&4294967295;l=l+v&4294967295;c=c+m&4294967295;h=h+g&4294967295;p=p+y&4294967295}var b=r(f)+r(l)+r(c)+r(h)+r(p);return b.toLowerCase()};


/*
 * Needs SHA1, JSON
 */

/**
 * Class TaggingEngine
 *
 * @access public
 * @param String $element (optional)
 * @param Object opts (optional)
 */
var TaggingEngine = function($element, opts) {
	this.$element = null; // wrapper
	this._opts = (typeof opts !== 'undefined') ? opts : null;
	this._eventNS = 'TaggingEngine'+String(Math.random()).replace('.', '');

	this._id = '';
	this._width = 768;
	this._height = 432;
	this._taggingUpdateOnClipLoad = false;
	this._taggingDisabled = false;
	this._useFallbackViewpage = false;
	this._clip = null;
	this._baseurl = null;
	
	if (this._opts && this._opts['publicationData'] && this._opts['publicationData']['baseurl']) this._baseurl = this._opts['publicationData']['baseurl'];

	if (this._opts && this._opts['embedData'] && this._baseurl) {
		if (this._opts['embedData']['contentIndicator'] == 'c') {
			this._id = this._baseurl +
				'/view/' + this._opts['embedData']['playoutSafeName'] +
				'/' + encodeURIComponent(this._opts['embedData']['contentId']) +
				'.html?placementOption=default';
		} else {
			this._id = this._baseurl +
				'/' + this._opts['embedData']['playoutIndicator'] +
				'/' + this._opts['embedData']['playoutSafeName'] +
				'/' + this._opts['embedData']['contentIndicator'] +
				'/' + encodeURIComponent(this._opts['embedData']['contentId']) +
				'.html?placementOption=default';
		}
	}

	if (this._opts && this._opts['playoutData']) {
		if (!isNaN(parseFloat(this._opts['playoutData']['width']))) this._width = this._opts['playoutData']['width'];
		if (!isNaN(parseFloat(this._opts['playoutData']['height']))) this._height = this._opts['playoutData']['height'];
		if (typeof this._opts['playoutData']['taggingUpdateOnClipLoad'] !== 'undefined') this._taggingUpdateOnClipLoad = (this._opts['playoutData']['taggingUpdateOnClipLoad'] == 'true');
		if (typeof this._opts['playoutData']['taggingDisabled'] !== 'undefined') this._taggingDisabled = (this._opts['playoutData']['taggingDisabled'] == 'true');
		if (typeof this._opts['playoutData']['useFallbackViewpage'] !== 'undefined') this._useFallbackViewpage = (this._opts['playoutData']['useFallbackViewpage'] == 'true');
	}

	if (this._opts && this._opts['clipData']) {
		this._clip = this._opts['clipData'];
	}
	if (this._opts && this._opts['projectData']) {
		this._project = this._opts['projectData'];
	}
	
	// element
	if (typeof $element != 'undefined' && $element != null) {
		this.$element = $element;
	
		// events
		this.$element.bind('bb_playout_loaded.'+this._eventNS, $.proxy(this._onPlayoutLoaded, this));
		this.$element.bind('bb_playout_changed.'+this._eventNS, $.proxy(this._onPlayoutLoaded, this));
		this.$element.bind('bb_mediaclip_loaded.'+this._eventNS, $.proxy(this._onClipLoaded, this));
	}

	this._update();
};

// public
TaggingEngine.prototype.exit = function() {
	if (this.$element != null) {
		this.$element.unbind('bb_playout_loaded.'+this._eventNS);
		this.$element.unbind('bb_playout_changed.'+this._eventNS);
		this.$element.unbind('bb_mediaclip_loaded.'+this._eventNS);
	}
	return null;
};

// private
TaggingEngine.prototype._onPlayoutLoaded = function(ev, payload) {
	if (payload && typeof payload['playoutData'] != 'undefined' && payload['playoutData'] != null) {
		if (!isNaN(parseFloat(payload['playoutData']['width']))) this._width = payload['playoutData']['width'];
		if (!isNaN(parseFloat(payload['playoutData']['height']))) this._height = payload['playoutData']['height'];
		if (typeof payload['playoutData']['taggingUpdateOnClipLoad'] !== 'undefined') this._taggingUpdateOnClipLoad = (payload['playoutData']['taggingUpdateOnClipLoad'] == 'true');
		if (typeof payload['playoutData']['taggingDisabled'] !== 'undefined') this._taggingDisabled = (payload['playoutData']['taggingDisabled'] == 'true');
		if (typeof payload['playoutData']['useFallbackViewpage'] !== 'undefined') this._useFallbackViewpage = (payload['playoutData']['useFallbackViewpage'] == 'true');
	}
};

// private
TaggingEngine.prototype._onClipLoaded = function(ev, payload) {
	if (payload && typeof payload['clipData'] !== 'undefined') {
		this._clip = payload['clipData'];
		
		if (this._taggingUpdateOnClipLoad) {
			this._update();
		}
	}
};

// private
TaggingEngine.prototype._update = function() {
	if (!this._taggingDisabled && this._clip && this._clip['id'] > 0 && this._clip['mediatype'] !== 'mainroll') {
		if (this.jsonld == null) {
			this.jsonld = document.createElement('script');
			this.jsonld.setAttribute('type', 'application/ld+json');
			document.head.appendChild(this.jsonld);
			try {
				this.jsonld.setAttribute('id', SHA1(this._id));
			} catch(er) {}
		}

		var clipOrProject = (this._project) ? this._project : this._clip;

		if (this.jsonld) {
			var type = (this._clip['mediatype'] == 'video') ? 'VideoObject' : ((this._clip['mediatype'] == 'audio') ? 'AudioObject' : 'MediaObject');
			var data = {"@context":"http://schema.org/","@type":type,"@id":this._id};

			if (type == 'VideoObject' || type == 'AudioObject') {
				if (clipOrProject['transcript']) {
					data['transcript'] = clipOrProject['transcript'];
				}
			}
			if (type == 'VideoObject') {
				data['caption'] = clipOrProject['title'];
				//data['videoFrameSize'] = '';
				//data['videoQuality'] = '';
			}

			// MediaObject
			//data['bitrate'] = '';
			//data['contentSize'] = ''; // NB not disclosed!
			//data['contentUrl'] = ''; // NB not disclosed!
			if (!isNaN(parseFloat(this._clip['length'])) && this._clip['length'] >= 0) { // is numeric and non-negative
				data['duration'] = TaggingEngine.ISO8601DurationString(this._clip['length']);
			}
			data['embedUrl'] = this._id; // <embed> src or <iframe> src? getEmbedcode?
			//data['encodingFormat'] = '';
			//data['expires'] = ''; // embargo?
			if (this._opts && this._opts['playoutData'] && !isNaN(parseFloat(this._opts['playoutData']['height']))) data['height'] = this._opts['playoutData']['height'];
			//data['playerType'] = ''; // NB not disclosed!
			//data['requiresSubscription'] = '';
			data['uploadDate'] = TaggingEngine.ISO8601DateString(this._clip['createddate']); // ISO 8601 Date or Time ( https://en.wikipedia.org/wiki/ISO_8601 )
			if (this._opts && this._opts['playoutData'] && !isNaN(parseFloat(this._opts['playoutData']['width']))) data['width'] = this._opts['playoutData']['width'];

			// CreativeWork
			//data['accessibilityAPI'] = '';
			//data['accessibilityControl'] = '';
			//data['accessibilityFeature'] = '';
			//data['accessibilityHazard'] = '';
			//data['alternativeHeadline'] = '';
			if (clipOrProject['author']) {
				data['author'] = clipOrProject['author'];
			}
			//data['award'] = '';
			//data['citation'] = '';
			//data['contentRating'] = '';
			if (clipOrProject['copyright']) {
				data['copyrightHolder'] = clipOrProject['copyright'];
			}
			data['dateCreated'] = TaggingEngine.ISO8601DateString(this._clip['createddate']);
			//data['dateModified'] = ''; // ISO 8601 Date or Time ( https://en.wikipedia.org/wiki/ISO_8601 )
			if (typeof this._clip['publisheddate'] !== 'undefined') {
				data['datePublished'] = TaggingEngine.ISO8601DateString(this._clip['publisheddate']);
			}
			//data['educationalUse'] = '';
			//data['fileFormat'] = ''; // NB not disclosed!
			//data['genre'] = '';
			//data['headline'] = '';
			//data['inLanguage'] = ''; // IETF BCP 47
			//data['interactivityType'] = ''; // 'active', 'expositive', or 'mixed'
			if (clipOrProject['cat']) {
				data['keywords'] = clipOrProject['cat'];
			}
			//data['learningResourceType'] = '';
			//data['text'] = '';
			data['thumbnailUrl'] = this._getThumbnail(); // avoid this._api.getThumbnail(this._clip['id']);
			//data['typicalAgeRange'] = ''; // e.g. '7-9', '11-'

			// Thing
			//data['alternateName'] = '';
			if (clipOrProject['description']) {
				data['description'] = clipOrProject['description'];
			}
			data['name'] = clipOrProject['title'];
			data['url'] = this._getDeeplink(); // avoid this._api.getDeeplink()
			if (typeof this._clip['views'] !== 'undefined') {
				// see: http://schema.org/interactionStatistic => JSON-LD
				switch (type) {
					case 'VideoObject':
					data['interactionStatistic'] = {"@type":"InteractionCounter", "interactionType":"http://schema.org/WatchAction", "userInteractionCount":this._clip['views'].toString()};
					break;

					case 'AudioObject':
					data['interactionStatistic'] = {"@type":"InteractionCounter", "interactionType":"http://schema.org/ListenAction", "userInteractionCount":this._clip['views'].toString()};
					break;

					default:
					case 'MediaObject':
					data['interactionStatistic'] = {"@type":"InteractionCounter", "interactionType":"http://schema.org/ConsumeAction", "userInteractionCount":this._clip['views'].toString()};
					break;
				}
			}

			try {
				this.jsonld.innerHTML = '';
				this.jsonld.appendChild(document.createTextNode(JSON.stringify(data)));
			} catch(er) {}
		}
	}
};

/**
 * ISO 8601 Duration (see: https://en.wikipedia.org/wiki/ISO_8601 )
 *
 * @access static
 * @param mixed duration in seconds
 * @return String ISO8601 Duration
 */
TaggingEngine.ISO8601DurationString = function(duration) {
	var d = new Date(duration * 1000); // milliseconds
    return 'PT'+d.getUTCHours()+'H'+d.getUTCMinutes()+'M'+d.getUTCSeconds()+'S';
};

/**
 * ISO 8601 Date (see: https://en.wikipedia.org/wiki/ISO_8601 )
 *
 * @access static
 * @param String date
 * @return String ISO8601 Date
 */
TaggingEngine.ISO8601DateString = function(date) {
    function pad(n) {return n<10 ? '0'+n : n}
	var d = new Date(date);
    return d.getUTCFullYear()+'-'+pad(d.getUTCMonth()+1)+'-'+pad(d.getUTCDate());
};

// private
TaggingEngine.prototype._getThumbnail = function() {
	var thumbnail = '';

	if (this._baseurl && this._clip) {
		thumbnail = this._baseurl+'/mediaclip/'+this._clip['id']+'/pthumbnail/640/default';
	}
	
	return thumbnail;
};

// private
TaggingEngine.prototype._getDeeplink = function() {
	var deeplink = (this._useFallbackViewpage && this._id) ? this._id : window.location.href;

	var clipOrProject = (this._project) ? this._project : this._clip;

	if (clipOrProject) {
		if (typeof clipOrProject['gendeeplink'] != 'undefined' && clipOrProject['gendeeplink'] != null) {
			var dl = clipOrProject['gendeeplink'];
			if (dl.match(/^\w+:\/\//) != null || dl.match(/^\/\//) != null) { deeplink = dl; } // fully-qualified url
		}
		if (typeof clipOrProject['deeplink'] != 'undefined' && clipOrProject['deeplink'] != null) {
			var dl = clipOrProject['deeplink'];
			if (dl.match(/^\w+:\/\//) != null || dl.match(/^\/\//) != null) { deeplink = dl; } // fully-qualified url
		}
	}
	
	return deeplink;
};

var taggingengine = new TaggingEngine(null, opts);
})(opts); // end closure;

	// NB leave empty line above!
	})();
	